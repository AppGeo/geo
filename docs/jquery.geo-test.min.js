document.createElement("canvas").getContext||function(){function f(){return this.context_||(this.context_=new n(this))}function p(h,k){var o=J.call(arguments,2);return function(){return h.apply(k,o.concat(J.call(arguments)))}}function q(h){h.namespaces.g_vml_||h.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");h.namespaces.g_o_||h.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!h.styleSheets.ex_canvas_){h=h.createStyleSheet();h.owningElement.id=
"ex_canvas_";h.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function a(h){var k=h.srcElement;switch(h.propertyName){case "width":k.getContext().clearRect();k.style.width=k.attributes.width.nodeValue+"px";k.firstChild.style.width=k.clientWidth+"px";break;case "height":k.getContext().clearRect();k.style.height=k.attributes.height.nodeValue+"px";k.firstChild.style.height=k.clientHeight+"px"}}function b(h){h=h.srcElement;if(h.firstChild){h.firstChild.style.width=
h.clientWidth+"px";h.firstChild.style.height=h.clientHeight+"px"}}function c(){return[[1,0,0],[0,1,0],[0,0,1]]}function d(h,k){for(var o=c(),s=0;s<3;s++)for(var w=0;w<3;w++){for(var t=0,K=0;K<3;K++)t+=h[s][K]*k[K][w];o[s][w]=t}return o}function e(h,k){k.fillStyle=h.fillStyle;k.lineCap=h.lineCap;k.lineJoin=h.lineJoin;k.lineWidth=h.lineWidth;k.miterLimit=h.miterLimit;k.shadowBlur=h.shadowBlur;k.shadowColor=h.shadowColor;k.shadowOffsetX=h.shadowOffsetX;k.shadowOffsetY=h.shadowOffsetY;k.strokeStyle=h.strokeStyle;
k.globalAlpha=h.globalAlpha;k.font=h.font;k.textAlign=h.textAlign;k.textBaseline=h.textBaseline;k.arcScaleX_=h.arcScaleX_;k.arcScaleY_=h.arcScaleY_;k.lineScale_=h.lineScale_}function l(h){var k=h.indexOf("(",3),o=h.indexOf(")",k+1);k=h.substring(k+1,o).split(",");if(k.length!=4||h.charAt(3)!="a")k[3]=1;return k}function g(h,k,o){return Math.min(o,Math.max(k,h))}function j(h,k,o){o<0&&o++;o>1&&o--;return 6*o<1?h+(k-h)*6*o:2*o<1?k:3*o<2?h+(k-h)*(2/3-o)*6:h}function m(h){if(h in L)return L[h];var k,
o=1;h=String(h);if(h.charAt(0)=="#")k=h;else if(/^rgb/.test(h)){o=l(h);k="#";for(var s,w=0;w<3;w++){s=o[w].indexOf("%")!=-1?Math.floor(parseFloat(o[w])/100*255):+o[w];k+=H[g(s,0,255)]}o=+o[3]}else if(/^hsl/.test(h)){w=o=l(h);k=parseFloat(w[0])/360%360;k<0&&k++;s=g(parseFloat(w[1])/100,0,1);w=g(parseFloat(w[2])/100,0,1);if(s==0)s=w=k=w;else{var t=w<0.5?w*(1+s):w+s-w*s,K=2*w-t;s=j(K,t,k+1/3);w=j(K,t,k);k=j(K,t,k-1/3)}k="#"+H[Math.floor(s*255)]+H[Math.floor(w*255)]+H[Math.floor(k*255)];o=o[3]}else k=
h;return L[h]={color:k,alpha:o}}function n(h){this.m_=c();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=B*1;this.globalAlpha=1;this.canvas=h;var k="width:"+h.clientWidth+"px;height:"+h.clientHeight+"px;overflow:hidden;position:absolute",o=h.ownerDocument.createElement("div");o.style.cssText=k;h.appendChild(o);k=o.cloneNode(false);k.style.backgroundColor="red";k.style.filter="alpha(opacity=0)";
h.appendChild(k);this.element_=o;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function v(h,k,o,s){h.currentPath_.push({type:"bezierCurveTo",cp1x:k.x,cp1y:k.y,cp2x:o.x,cp2y:o.y,x:s.x,y:s.y});h.currentX_=s.x;h.currentY_=s.y}function u(h,k,o){h=h.m_;return{x:B*(k*h[0][0]+o*h[1][0]+h[2][0])-D,y:B*(k*h[0][1]+o*h[1][1]+h[2][1])-D}}function z(h,k,o){if(isFinite(k[0][0])&&isFinite(k[0][1])&&isFinite(k[1][0])&&isFinite(k[1][1])&&isFinite(k[2][0])&&isFinite(k[2][1])){h.m_=k;if(o)h.lineScale_=E(G(k[0][0]*
k[1][1]-k[0][1]*k[1][0]))}}function A(h){this.code=this[h];this.message=h+": DOM Exception "+this.code}var y=Math,x=y.round,C=y.sin,F=y.cos,G=y.abs,E=y.sqrt,B=10,D=B/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var J=Array.prototype.slice;q(document);y={init:function(h){h=h||document;h.createElement("canvas");h.attachEvent("onreadystatechange",p(this.init_,this,h))},init_:function(h){h=h.getElementsByTagName("canvas");for(var k=0;k<h.length;k++)this.initElement(h[k])},initElement:function(h){if(!h.getContext){h.getContext=
f;q(h.ownerDocument);h.innerHTML="";h.attachEvent("onpropertychange",a);h.attachEvent("onresize",b);var k=h.attributes;if(k.width&&k.width.specified)h.style.width=k.width.nodeValue+"px";else h.width=h.clientWidth;if(k.height&&k.height.specified)h.style.height=k.height.nodeValue+"px";else h.height=h.clientHeight}return h}};y.init();for(var H=[],r=0;r<16;r++)for(var I=0;I<16;I++)H[r*16+I]=r.toString(16)+I.toString(16);var L={},N={butt:"flat",round:"round"};r=n.prototype;r.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);
this.textMeasureEl_=null}this.element_.innerHTML=""};r.beginPath=function(){this.currentPath_=[]};r.moveTo=function(h,k){var o=u(this,h,k);this.currentPath_.push({type:"moveTo",x:o.x,y:o.y});this.currentX_=o.x;this.currentY_=o.y};r.lineTo=function(h,k){var o=u(this,h,k);this.currentPath_.push({type:"lineTo",x:o.x,y:o.y});this.currentX_=o.x;this.currentY_=o.y};r.bezierCurveTo=function(h,k,o,s,w,t){w=u(this,w,t);h=u(this,h,k);o=u(this,o,s);v(this,h,o,w)};r.quadraticCurveTo=function(h,k,o,s){h=u(this,
h,k);o=u(this,o,s);s={x:this.currentX_+2/3*(h.x-this.currentX_),y:this.currentY_+2/3*(h.y-this.currentY_)};v(this,s,{x:s.x+(o.x-this.currentX_)/3,y:s.y+(o.y-this.currentY_)/3},o)};r.arc=function(h,k,o,s,w,t){o*=B;var K=t?"at":"wa",M=h+F(s)*o-D,O=k+C(s)*o-D;s=h+F(w)*o-D;w=k+C(w)*o-D;if(M==s&&!t)M+=0.125;h=u(this,h,k);M=u(this,M,O);s=u(this,s,w);this.currentPath_.push({type:K,x:h.x,y:h.y,radius:o,xStart:M.x,yStart:M.y,xEnd:s.x,yEnd:s.y})};r.stroke=function(h){var k=[];k.push("<g_vml_:shape",' filled="',
!!h,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',B*10,",",B*10,'"',' stroked="',!h,'"',' path="');for(var o={x:null,y:null},s={x:null,y:null},w=0;w<this.currentPath_.length;w++){var t=this.currentPath_[w];switch(t.type){case "moveTo":k.push(" m ",x(t.x),",",x(t.y));break;case "lineTo":k.push(" l ",x(t.x),",",x(t.y));break;case "close":k.push(" x ");t=null;break;case "bezierCurveTo":k.push(" c ",x(t.cp1x),",",x(t.cp1y),",",x(t.cp2x),",",x(t.cp2y),
",",x(t.x),",",x(t.y));break;case "at":case "wa":k.push(" ",t.type," ",x(t.x-this.arcScaleX_*t.radius),",",x(t.y-this.arcScaleY_*t.radius)," ",x(t.x+this.arcScaleX_*t.radius),",",x(t.y+this.arcScaleY_*t.radius)," ",x(t.xStart),",",x(t.yStart)," ",x(t.xEnd),",",x(t.yEnd))}if(t){if(o.x==null||t.x<o.x)o.x=t.x;if(s.x==null||t.x>s.x)s.x=t.x;if(o.y==null||t.y<o.y)o.y=t.y;if(s.y==null||t.y>s.y)s.y=t.y}}k.push(' ">');if(h){h=m(this.fillStyle);k.push('<g_vml_:fill color="',h.color,'" opacity="',h.alpha*this.globalAlpha,
'" />')}else{o=m(this.strokeStyle);h=o.color;o=o.alpha*this.globalAlpha;s=this.lineScale_*this.lineWidth;if(s<1)o*=s;k.push("<g_vml_:stroke",' opacity="',o,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',N[this.lineCap]||"square",'"',' weight="',s,'px"',' color="',h,'" />')}k.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",k.join(""))};r.fill=function(){this.stroke(true)};r.closePath=function(){this.currentPath_.push({type:"close"})};r.save=
function(){var h={};e(this,h);this.aStack_.push(h);this.mStack_.push(this.m_);this.m_=d(c(),this.m_)};r.restore=function(){if(this.aStack_.length){e(this.aStack_.pop(),this);this.m_=this.mStack_.pop()}};r.translate=function(h,k){z(this,d([[1,0,0],[0,1,0],[h,k,1]],this.m_),false)};r.scale=function(h,k){this.arcScaleX_*=h;this.arcScaleY_*=k;z(this,d([[h,0,0],[0,k,0],[0,0,1]],this.m_),true)};r=A.prototype=Error();r.INDEX_SIZE_ERR=1;r.DOMSTRING_SIZE_ERR=2;r.HIERARCHY_REQUEST_ERR=3;r.WRONG_DOCUMENT_ERR=
4;r.INVALID_CHARACTER_ERR=5;r.NO_DATA_ALLOWED_ERR=6;r.NO_MODIFICATION_ALLOWED_ERR=7;r.NOT_FOUND_ERR=8;r.NOT_SUPPORTED_ERR=9;r.INUSE_ATTRIBUTE_ERR=10;r.INVALID_STATE_ERR=11;r.SYNTAX_ERR=12;r.INVALID_MODIFICATION_ERR=13;r.NAMESPACE_ERR=14;r.INVALID_ACCESS_ERR=15;r.VALIDATION_ERR=16;r.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=y;CanvasRenderingContext2D=n;DOMException=A}();
(function(f){function p(a){var b=[].slice.call(arguments,1),c=0;a=f.event.fix(a||window.event);a.type="mousewheel";if(a.wheelDelta)c=a.wheelDelta/120;if(a.detail)c=-a.detail/3;b.unshift(a,c);return f.event.handle.apply(this,b)}var q=["DOMMouseScroll","mousewheel"];f.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=q.length;a;)this.addEventListener(q[--a],p,false);else this.onmousewheel=p},teardown:function(){if(this.removeEventListener)for(var a=q.length;a;)this.removeEventListener(q[--a],
p,false);else this.onmousewheel=null}};f.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
$.widget||function(f,p){var q=Array.prototype.slice,a=f.cleanData;f.cleanData=function(b){for(var c=0,d;(d=b[c])!=null;c++)f(d).triggerHandler("remove");a(b)};f.widget=function(b,c,d){var e=b.split(".")[0],l;b=b.split(".")[1];l=e+"-"+b;if(!d){d=c;c=f.Widget}f.expr[":"][l]=function(j){return!!f.data(j,b)};f[e]=f[e]||{};f[e][b]=f.extend(function(j,m){if(!this._createWidget)return new f[e][b](j,m);arguments.length&&this._createWidget(j,m)},f[e][b]);var g=new c;g.options=f.extend(true,{},g.options);f.each(d,
function(j,m){if(f.isFunction(m))d[j]=function(){var n=function(u){return c.prototype[u].apply(this,q.call(arguments,1))},v=function(u,z){return c.prototype[u].apply(this,z)};return function(){var u=this._super,z=this._superApply,A;this._super=n;this._superApply=v;A=m.apply(this,arguments);this._super=u;this._superApply=z;return A}}()});f[e][b].prototype=f.extend(true,g,{namespace:e,widgetName:b,widgetEventPrefix:b,widgetBaseClass:l},d);f.widget.bridge(b,f[e][b])};f.widget.bridge=function(b,c){f.fn[b]=
function(d){var e=typeof d==="string",l=q.call(arguments,1),g=this;d=!e&&l.length?f.extend.apply(null,[true,d].concat(l)):d;e?this.each(function(){var j=f.data(this,b);if(!j)return f.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+d+"'");if(!f.isFunction(j[d])||d.charAt(0)==="_")return f.error("no such method '"+d+"' for "+b+" widget instance");var m=j[d].apply(j,l);if(m!==j&&m!==p){g=m;return false}}):this.each(function(){var j=f.data(this,b);j?j.option(d||
{})._init():c(d,this)});return g}};f.Widget=function(b,c){if(!this._createWidget)return new f[namespace][name](b,c);arguments.length&&this._createWidget(b,c)};f.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false},_createWidget:function(b,c){c=f(c||this.defaultElement||this)[0];this.element=f(c);this.options=f.extend(true,{},this.options,this._getCreateOptions(),b);this.bindings=f();this.hoverable=f();this.focusable=f();if(c!==this){f.data(c,this.widgetName,
this);this._bind({remove:"destroy"})}this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return f.metadata&&f.metadata.get(this.element[0])[this.widgetName]},_create:f.noop,_init:f.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus")},_destroy:f.noop,widget:function(){return this.element},option:function(b,c){var d=b;if(arguments.length===0)return f.extend({},this.options);if(typeof b==="string"){if(c===p)return this.options[b];d={};d[b]=c}this._setOptions(d);return this},_setOptions:function(b){var c=this;f.each(b,function(d,e){c._setOption(d,e)});return this},_setOption:function(b,c){this.options[b]=c;if(b==="disabled"){this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",
!!c).attr("aria-disabled",c);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_bind:function(b,c){if(c){b=f(b);this.bindings=this.bindings.add(b)}else{c=b;b=this.element}var d=this;f.each(c,function(e,l){b.bind(e+"."+d.widgetName,function(){if(!(d.options.disabled===true||f(this).hasClass("ui-state-disabled")))return(typeof l===
"string"?d[l]:l).apply(d,arguments)})})},_hoverable:function(b){this.hoverable=this.hoverable.add(b);this._bind(b,{mouseenter:function(c){f(c.currentTarget).addClass("ui-state-hover")},mouseleave:function(c){f(c.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b);this._bind(b,{focusin:function(c){f(c.currentTarget).addClass("ui-state-focus")},focusout:function(c){f(c.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e=
this.options[b];c=f.Event(c);c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d=d||{};if(c.originalEvent){b=f.event.props.length;for(var l;b;){l=f.event.props[--b];c[l]=c.originalEvent[l]}}this.element.trigger(c,d);d=f.isArray(d)?[c].concat(d):[c,d];return!(f.isFunction(e)&&e.apply(this.element[0],d)===false||c.isDefaultPrevented())}}}(jQuery);
(function(f){var p=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY;f.geo={_allCoordinates:function(a){a=this._flatten(a);for(var b=0,c=[];b<a.length;b++){var d=a[b].coordinates,e=f.isArray(d[0]),l=e&&f.isArray(d[0][0]),g;if(!(l&&f.isArray(d[0][0][0]))){if(!l){e||(d=[d]);d=[d]}d=[d]}for(e=0;e<d.length;e++)for(l=0;l<d[e].length;l++)for(g=0;g<d[e][l].length;g++)c.push(d[e][l][g])}return c},_center:function(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]},_expandBy:function(a,b,c){return[a[0]-b,a[1]-c,a[2]+
b,a[3]+c]},_height:function(a){return a[3]-a[1]},_reaspect:function(a,b){var c=this._width(a),d=this._height(a),e=this._center(a);if(c==0||d==0||b<=0)return a;if(c/d>b){c=c/2;d=c/b}else{d=d/2;c=d*b}return[e[0]-c,e[1]-d,e[0]+c,e[1]+d]},_scaleBy:function(a,b){var c=this._center(a),d=(a[2]-a[0])*b/2,e=(a[3]-a[1])*b/2;return[c[0]-d,c[1]-e,c[0]+d,c[1]+e]},_width:function(a){return a[2]-a[0]},_bbox:function(a){var b=f.data(a,"geoBbox");if(!b)if(a.bbox)f.data(a,"geoBbox",b=a.bbox);else{b=[p,p,q,q];for(var c=
this._allCoordinates(a),d=0;d<c.length;d++){b[0]=Math.min(c[d][0],b[0]);b[1]=Math.min(c[d][1],b[1]);b[2]=Math.max(c[d][0],b[2]);b[3]=Math.max(c[d][1],b[3])}f.data(a,"geoBbox",b)}return b},_contains:function(a,b){if(a.type!="Polygon")return false;switch(b.type){case "Point":return this._containsPolygonPoint(a.coordinates,b.coordinates);case "LineString":return this._containsPolygonLineString(a.coordinates,b.coordinates);case "Polygon":return this._containsPolygonLineString(a.coordinates,b.coordinates[0])}},
_containsPolygonPoint:function(a,b){if(a.length==0||a[0].length<4)return false;for(var c=0,d=a[0][0],e=1,l;e<a[0].length;e++){l=a[0][e];if(d[1]<=b[1]&&b[1]<l[1]||l[1]<=b[1]&&b[1]<d[1]&&(b[0]<d[0]||b[0]<l[0])){d=d[0]+(l[0]-d[0])*(b[1]-d[1])/(l[1]-d[1]);d>b[0]&&c++}d=l}return c%2==1},_containsPolygonLineString:function(a,b){for(var c=0;c<b.length;c++)if(!this._containsPolygonPoint(a,b[c]))return false;return true},_distance:function(a,b){var c=f.isArray(a)?a:a.coordinates,d=f.isArray(b)?b:b.coordinates;
c=f.geo.proj?f.geo.proj.fromGeodetic(c):c;d=f.geo.proj?f.geo.proj.fromGeodetic(d):d;switch(a.type){case "Point":switch(b.type){case "Point":return this._distancePointPoint(d,c);case "LineString":return this._distanceLineStringPoint(d,c);case "Polygon":return this._containsPolygonPoint(d,c)?0:this._distanceLineStringPoint(d[0],c);default:throw Error("not implemented");}case "LineString":switch(b.type){case "Point":return this._distanceLineStringPoint(c,d);case "LineString":return this._distanceLineStringLineString(c,
d);case "Polygon":return this._containsPolygonLineString(d,c)?0:this._distanceLineStringLineString(d[0],c);default:throw Error("not implemented");}case "Polygon":switch(b.type){case "Point":return this._containsPolygonPoint(c,d)?0:this._distanceLineStringPoint(c[0],d);case "LineString":return this._containsPolygonLineString(c,d)?0:this._distanceLineStringLineString(c[0],d);case "Polygon":return this._containsPolygonLineString(c,d[0])?0:this._distanceLineStringLineString(c[0],d[0]);default:throw Error("not implemented");
}}},_distancePointPoint:function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},_distanceLineStringPoint:function(a,b){var c=p;if(a.length>0){var d=a[0],e=b[0]-d[0],l=b[1]-d[1];if(a.length==1)return Math.sqrt(e*e+l*l);else for(var g=1;g<a.length;g++){var j=a[g],m=b[0]-j[0],n=b[1]-j[1];d=this._distanceSegmentPoint(j[0]-d[0],j[1]-d[1],e,l,m,n);if(d==0)return 0;if(d<c)c=d;d=j;e=m;l=n}}return Math.sqrt(c)},_distanceSegmentPoint:function(a,b,c,d,e,l){var g=a*c+b*d;if(g<=0)return c*c+d*d;a=
a*a+b*b;if(g>=a)return e*e+l*l;return c*c+d*d-g*g/a},_distanceLineStringLineString:function(a,b){for(var c=p,d=0;d<b;d++)c=Math.min(c,this._distanceLineStringPoint(a,b[d]));return c},_flatten:function(a){var b=[];switch(a.type){case "Feature":f.merge(b,this._flatten(a.geometry));break;case "GeometryCollection":for(curGeom=0;curGeom<a.geometries.length;curGeom++)f.merge(b,this._flatten(a.geometries[curGeom]));break;default:b[0]=a}return b},proj:function(){return{fromGeodeticPos:function(a){return[6378137*
a[0]*0.017453292519943295,6378137*Math.log(Math.tan(0.7853981633974483+a[1]*0.017453292519943295/2))]},fromGeodetic:function(a){var b=f.isArray(a[0]),c=b&&f.isArray(a[0][0]),d=c&&f.isArray(a[0][0][0]),e=[[[]]],l=this.fromGeodeticPos;if(!d){if(!c){b||(a=[a]);a=[a]}a=[a]}f.each(a,function(g){f.each(this,function(j){f.each(this,function(m){e[g][j][m]=l(this)})})});return d?e:c?e[0]:b?e[0][0]:e[0][0][0]},toGeodeticPos:function(a){return[a[0]/6378137*57.29577951308232,(1.5707963267948966-2*Math.atan(1/
Math.exp(a[1]/6378137)))*57.29577951308232]},toGeodetic:function(a){var b=f.isArray(a[0]),c=b&&f.isArray(a[0][0]),d=c&&f.isArray(a[0][0][0]),e=[[[]]],l=this.toGeodeticPos;if(!d){if(!c){b||(a=[a]);a=[a]}a=[a]}f.each(a,function(g){f.each(this,function(j){f.each(this,function(m){e[g][j][m]=l(this)})})});return d?e:c?e[0]:b?e[0][0]:e[0][0][0]}}}(),_serviceTypes:{}}})(jQuery,this);
(function(f){var p,q,a=true,b,c,d,e,l=function(){for(var g=5,j=document.createElement("div"),m=j.all||[];j.innerHTML="<!--[if gt IE "+ ++g+"]><br><![endif]--\>",m[0];);return g>6?g:!g}();f.widget("geo.geographics",{options:{style:{borderRadius:"8px",color:"#7f0000",fillOpacity:0.2,height:"8px",opacity:1,strokeOpacity:1,strokeWidth:"2px",visibility:"visible",width:"8px"}},_create:function(){p=this.element;q=this.options;p.css({display:"inline-block",overflow:"hidden",textAlign:"left"});p.css("position")==
"static"&&p.css("position","relative");b=p.width();c=p.height();if(!(b&&c)){b=parseInt(p.css("width"));c=parseInt(p.css("height"))}if(document.createElement("canvas").getContext){p.append('<canvas width="'+b+'" height="'+c+'" style="position:absolute; left:0; top:0; width:'+b+"px; height:"+c+'px;"></canvas>');d=p.children(":last");e=d[0].getContext("2d")}else if(l<=8){a=false;p.append('<div width="'+b+'" height="'+c+'" style="position:absolute; left:0; top:0; width:'+b+"px; height:"+c+'px; margin:0; padding:0;"></div>');
d=p.children(":last");G_vmlCanvasManager.initElement(d[0]);e=d[0].getContext("2d");d.children().css({backgroundColor:"transparent",width:b,height:c})}},_setOption:function(g,j){if(g=="style")j=f.extend({},q.style,j);f.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){f.Widget.prototype.destroy.apply(this,arguments);p.html("")},clear:function(){e.clearRect(0,0,b,c)},drawArc:function(g,j,m,n){n=this._getGraphicStyle(n);if(n.visibility!="hidden"&&n.opacity>0&&n.widthValue>0&&n.heightValue>
0){var v=Math.min(n.widthValue,n.heightValue)/2;j=j*Math.PI/180;m=m*Math.PI/180;e.save();e.translate(g[0],g[1]);n.widthValue>n.heightValue?e.scale(n.widthValue/n.heightValue,1):e.scale(1,n.heightValue/n.widthValue);e.beginPath();e.arc(0,0,v,j,m,false);a&&e.restore();if(n.doFill){e.fillStyle=n.fill;e.globalAlpha=n.opacity*n.fillOpacity;e.fill()}if(n.doStroke){e.lineJoin="round";e.lineWidth=n.strokeWidthValue;e.strokeStyle=n.stroke;e.globalAlpha=n.opacity*n.strokeOpacity;e.stroke()}a||e.restore()}},
drawPoint:function(g,j){j=this._getGraphicStyle(j);if(j.widthValue==j.heightValue&&j.heightValue==j.borderRadiusValue)this.drawArc(g,0,360,j);else if(j.visibility!="hidden"&&j.opacity>0){j.borderRadiusValue=Math.min(Math.min(j.widthValue,j.heightValue)/2,j.borderRadiusValue);g[0]-=j.widthValue/2;g[1]-=j.heightValue/2;e.beginPath();e.moveTo(g[0]+j.borderRadiusValue,g[1]);e.lineTo(g[0]+j.widthValue-j.borderRadiusValue,g[1]);e.quadraticCurveTo(g[0]+j.widthValue,g[1],g[0]+j.widthValue,g[1]+j.borderRadiusValue);
e.lineTo(g[0]+j.widthValue,g[1]+j.heightValue-j.borderRadiusValue);e.quadraticCurveTo(g[0]+j.widthValue,g[1]+j.heightValue,g[0]+j.widthValue-j.borderRadiusValue,g[1]+j.heightValue);e.lineTo(g[0]+j.borderRadiusValue,g[1]+j.heightValue);e.quadraticCurveTo(g[0],g[1]+j.heightValue,g[0],g[1]+j.heightValue-j.borderRadiusValue);e.lineTo(g[0],g[1]+j.borderRadiusValue);e.quadraticCurveTo(g[0],g[1],g[0]+j.borderRadiusValue,g[1]);e.closePath();if(j.doFill){e.fillStyle=j.fill;e.globalAlpha=j.opacity*j.fillOpacity;
e.fill()}if(j.doStroke){e.lineJoin="round";e.lineWidth=j.strokeWidthValue;e.strokeStyle=j.stroke;e.globalAlpha=j.opacity*j.strokeOpacity;e.stroke()}}},drawLineString:function(g,j){this._drawLines([g],false,j)},drawPolygon:function(g,j){this._drawLines(g,true,j)},drawBbox:function(g,j){this._drawLines([[[g[0],g[1]],[g[0],g[3]],[g[2],g[3]],[g[2],g[1]],[g[0],g[1]]]],true,j)},_getGraphicStyle:function(g){function j(m){m=parseInt(m);return+m+""===m?+m:m}g=f.extend({},q.style,g);g.borderRadiusValue=j(g.borderRadius);
g.fill=g.fill||g.color;g.doFill=g.fill&&g.fillOpacity>0;g.stroke=g.stroke||g.color;g.strokeWidthValue=j(g.strokeWidth);g.doStroke=g.stroke&&g.strokeOpacity>0&&g.strokeWidthValue>0;g.widthValue=j(g.width);g.heightValue=j(g.height);return g},_drawLines:function(g,j,m){if(!(!g||!g.length||g[0].length<2)){m=this._getGraphicStyle(m);var n,v;if(m.visibility!="hidden"&&m.opacity>0){e.beginPath();e.moveTo(g[0][0][0],g[0][0][1]);var u=g[0][g[0].length-1];for(n=0;n<g.length;n++){for(v=0;v<g[n].length;v++)e.lineTo(g[n][v][0],
g[n][v][1]);if(j&&n>0){e.lineTo(u[0],u[1]);e.closePath()}}if(j&&m.doFill){e.fillStyle=m.fill;e.globalAlpha=m.opacity*m.fillOpacity;e.fill()}if(m.doStroke){e.lineJoin="round";e.lineWidth=m.strokeWidthValue;e.strokeStyle=m.stroke;e.globalAlpha=m.opacity*m.strokeOpacity;e.stroke()}}}}})})(jQuery);
(function(f,p){var q=function(){for(var a=5,b=document.createElement("div"),c=b.all||[];b.innerHTML="<!--[if gt IE "+ ++a+"]><br><![endif]--\>",c[0];);return a>6?a:!a}();f.widget("geo.geomap",{_$elem:p,_contentBounds:{},_$contentFrame:p,_$servicesContainer:p,_$shapesContainer:p,_$textContainer:p,_$textContent:p,_$eventTarget:p,_dpi:96,_currentServices:[],_center:p,_pixelSize:p,_centerMax:p,_pixelSizeMax:p,_wheelZoomFactor:1.18920711500273,_wheelTimer:null,_wheelLevel:0,_zoomFactor:2,_mouseDown:p,
_inOp:p,_toolPan:p,_shiftZoom:p,_anchor:p,_current:p,_downDate:p,_moveDate:p,_clickDate:p,_lastMove:p,_lastDrag:p,_timeoutResize:null,_panning:p,_velocity:p,_friction:p,_supportTouch:p,_softDblClick:p,_isTap:p,_isDbltap:p,_graphicShapes:[],_initOptions:{},_options:{},options:f.extend({},{bbox:[-180,-85,180,85],bboxMax:[-180,-85,180,85],center:[0,0],cursors:{pan:"move"},mode:"pan",services:[{id:"OSM",type:"tiled",getUrl:function(a){return"http://tile.openstreetmap.org/"+a.zoom+"/"+a.tile.column+"/"+
a.tile.row+".png"},attr:"&copy; OpenStreetMap &amp; contributors, CC-BY-SA"}],tilingScheme:{tileWidth:256,tileHeight:256,levels:18,basePixelSize:156543.03392799935,origin:[-2.0037508342787E7,2.0037508342787E7]},zoom:0}),_createWidget:function(a,b){this._$elem=f(b);if(!this._$elem.is("[data-geo-service]")){this._$elem.attr("data-geo-map","data-geo-map");this._initOptions=a;this._forcePosition(this._$elem);this._$elem.css("text-align","left");var c=this._findMapSize();this._contentBounds={x:parseInt(this._$elem.css("padding-left")),
y:parseInt(this._$elem.css("padding-top")),width:c.width,height:c.height};this._createChildren();this._center=this._centerMax=[0,0];this._pixelSize=this._pixelSizeMax=156543.03392799935;this._mouseDown=this._inOp=this._toolPan=this._shiftZoom=this._panning=this._isTap=this._isDbltap=false;this._anchor=this._current=this._lastMove=this._lastDrag=this._velocity=[0,0];this._friction=[0.8,0.8];this._downDate=this._moveDate=this._clickDate=0}f.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){if(!this._$elem.is("[data-geo-service]")){this._options=
this.options;this._softDblClick=(this._supportTouch="ontouchend"in document)||q==7;var a=this._supportTouch?"touchstart":"mousedown",b=this._supportTouch?"touchend touchcancel":"mouseup",c=this._supportTouch?"touchmove":"mousemove";this._$eventTarget.dblclick(f.proxy(this._eventTarget_dblclick,this));this._$eventTarget.bind(a,f.proxy(this._eventTarget_touchstart,this));a=this._$eventTarget[0].setCapture?this._$eventTarget:f(document);a.bind(c,f.proxy(this._dragTarget_touchmove,this));a.bind(b,f.proxy(this._dragTarget_touchstop,
this));this._$eventTarget.mousewheel(f.proxy(this._eventTarget_mousewheel,this));var d=this;f(window).resize(function(){d._timeoutResize&&clearTimeout(d._timeoutResize);this._timeoutResize=setTimeout(function(){d._$elem.geomap("resize")},500)});this._$shapesContainer.geographics();if(this._initOptions){this._initOptions.bbox&&this._setOption("bbox",this._initOptions.bbox,false);this._initOptions.center&&this._setOption("center",this._initOptions.center,false);this._initOptions.zoom&&this._setZoom(this._initOptions.zoom,
false,false)}this._$eventTarget.css("cursor",this._options.cursors[this._options.mode]);this._createServices();this._refresh()}},_setOption:function(a,b,c){if(!this._$elem.is("[data-geo-service]")){c=c===p||c;switch(a){case "bbox":if(f.geo.proj){b=f.geo.proj.fromGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}this._setBbox(b,false,c);b=this._getBbox();if(f.geo.proj){b=f.geo.proj.toGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}break;case "center":this._setCenterAndSize(f.geo.proj?
f.geo.proj.fromGeodetic([[b[0],b[1]]])[0]:b,this._pixelSize,false,c);break;case "zoom":this._setZoom(b,false,c)}f.Widget.prototype._setOption.apply(this,arguments);switch(a){case "services":this._createServices();c&&this._refresh()}}},destroy:function(){if(this._$elem.is("[data-geo-map]")){this._$elem.html("");this._$elem.removeAttr("data-geo-map")}f.Widget.prototype.destroy.apply(this,arguments)},getPixelSize:function(){return this._pixelSize},toMap:function(a){a=this._toMap(a);return f.geo.proj?
f.geo.proj.toGeodetic(a):a},toPixel:function(a){a=f.geo.proj?f.geo.proj.fromGeodetic(a):a;return this._toPixel(a)},opacity:function(a,b){if(this._$elem.is("[data-geo-service]"))this._$elem.closest("[data-geo-map]").geomap("opacity",a,this._$elem);else if(a>=0||a<=1)for(var c=0;c<this._currentServices.length;c++){var d=this._currentServices[c];if(!b||d.serviceContainer[0]==b[0]){this._options.services[c].opacity=d.opacity=a;f.geo._serviceTypes[d.type].opacity(this,d)}}},toggle:function(a,b){if(this._$elem.is("[data-geo-service]"))this._$elem.closest("[data-geo-map]").geomap("toggle",
a,this._$elem);else for(var c=0;c<this._currentServices.length;c++){var d=this._currentServices[c];if(!b||d.serviceContainer[0]==b[0]){if(a===p)a=d.visible===p?false:!d.visible;this._options.services[c].visible=d.visible=a;f.geo._serviceTypes[d.type].toggle(this,d)}}},refresh:function(){this._refresh()},resize:function(){var a=this._findMapSize();this._contentBounds={x:parseInt(this._$elem.css("padding-left")),y:parseInt(this._$elem.css("padding-top")),width:a.width,height:a.height};this._$contentFrame.css({width:a.width,
height:a.height});this._$servicesContainer.css({width:a.width,height:a.height});this._$eventTarget.css({width:a.width,height:a.height});this._$shapesContainer.geographics("destroy");this._$shapesContainer.css({width:a.width,height:a.height});this._$shapesContainer.geographics();this._setCenterAndSize(this._center,this._pixelSize,false,true)},shapeStyle:function(a){if(a){this._$shapesContainer.geographics("option","style",a);this._refresh()}else return this._$shapesContainer.geographics("option","style")},
append:function(a,b,c){c=c===p||c;if(a){var d=this;a=a.type=="FeatureCollection"?a.features:f.isArray(a)?a:[a];f.each(a,function(){d._graphicShapes[d._graphicShapes.length]={shape:this,style:b}});c&&this._refresh()}},empty:function(){this._graphicShapes=[];this._refresh()},find:function(a,b){this.toPixel(a.coordinates);var c=this._pixelSize*b,d=[],e;f.each(this._graphicShapes,function(){if(this.shape.type=="Point")f.geo._distance(this.shape,a)<=c&&d.push(this.shape);else{var l=f.geo._bbox(this.shape);
if(f.geo._distance({type:"Polygon",coordinates:[[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]],[l[0],l[1]]]]},a)<=c){l=f.geo._flatten(this.shape);for(e=0;e<l.length;e++)if(f.geo._distance(l[e],a)<=c){d.push(this.shape);break}}}});return d},remove:function(a){var b=this;f.each(this._graphicShapes,function(c){if(this.shape==a){var d=b._graphicShapes.slice(c+1||b._graphicShapes.length);b._graphicShapes.length=c<0?b._graphicShapes.length+c:c;b._graphicShapes.push.apply(b._graphicShapes,d);return false}});
this._refresh()},_getBbox:function(){var a=this._contentBounds.width/2*this._pixelSize,b=this._contentBounds.height/2*this._pixelSize;return[this._center[0]-a,this._center[1]-b,this._center[0]+a,this._center[1]+b]},_setBbox:function(a,b,c){var d=[a[0]+(a[2]-a[0])/2,a[1]+(a[3]-a[1])/2];a=Math.max(f.geo._width(a)/this._contentBounds.width,f.geo._height(a)/this._contentBounds.height);if(this._options.tilingScheme)a=this._getTiledPixelSize(this._getTiledZoom(a));this._setCenterAndSize(d,a,b,c)},_getBboxMax:function(){var a=
this._contentBounds.width/2*this._pixelSizeMax,b=this._contentBounds.height/2*this._pixelSizeMax;return[this._centerMax[0]-a,this._centerMax[1]-b,this._centerMax[0]+a,this._centerMax[1]+b]},_getCenter:function(){return this._center},_getContentBounds:function(){return this._contentBounds},_getZoom:function(){if(this._options.tilingScheme)return this._getTiledZoom(this._pixelSize);else{var a=this._contentBounds.width/this._contentBounds.height,b=f.geo._reaspect(this._getBbox(),a);a=f.geo._reaspect(this._getBboxMax(),
a);return Math.log(f.geo._width(a)/f.geo._width(b))/Math.log(this._zoomFactor)}},_setZoom:function(a,b,c){a=Math.max(a,0);if(this._options.tilingScheme)this._setCenterAndSize(this._center,this._getTiledPixelSize(a),b,c);else{a=f.geo._scaleBy(this._getBbox(),1/Math.pow(this._zoomFactor,a));this._setCenterAndSize(this._center,Math.max(f.geo._width(a)/this._contentBounds.width,f.geo._height(a)/this._contentBounds.height),b,c)}},_createChildren:function(){var a=this._$elem.children().detach();this._forcePosition(a);
a.css("-moz-user-select","none");this._$elem.prepend("<div style='position:absolute; left:"+this._contentBounds.x+"px; top:"+this._contentBounds.y+"px; width:"+this._contentBounds.width+"px; height:"+this._contentBounds.height+"px; margin:0; padding:0; overflow:hidden; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none;' unselectable='on'></div>");this._$eventTarget=this._$contentFrame=this._$elem.children(":first");this._$contentFrame.append('<div style="position:absolute; left:0; top:0; width:'+
this._contentBounds.width+"px; height:"+this._contentBounds.height+'px; margin:0; padding:0;"></div>');this._$servicesContainer=this._$contentFrame.children(":last");this._$contentFrame.append('<div style="position:absolute; left:0; top:0; width:'+this._contentBounds.width+"px; height:"+this._contentBounds.height+'px; margin:0; padding:0;"></div>');this._$shapesContainer=this._$contentFrame.children(":last");this._$contentFrame.append('<div class="ui-widget ui-widget-content ui-corner-all" style="position:absolute; left:0; top:0px; max-width:128px; display:none;"><div style="margin:.2em;"></div></div>');
this._$textContainer=this._$contentFrame.children(":last");this._$textContent=this._$textContainer.children();this._$contentFrame.append(a)},_createServices:function(){var a;for(a=0;a<this._currentServices.length;a++){this._currentServices[a].serviceContainer.geomap("destroy");f.geo._serviceTypes[this._currentServices[a].type].destroy(this,this._$servicesContainer,this._currentServices[a])}this._currentServices=[];for(a=0;a<this._options.services.length;a++){this._currentServices[a]=f.extend({},this._options.services[a]);
this._currentServices[a].serviceContainer=f.geo._serviceTypes[this._currentServices[a].type].create(this,this._$servicesContainer,this._currentServices[a],a).geomap()}},_drawGraphics:function(a,b,c){var d,e,l,g,j,m=this;for(d=0;d<b.length;d++){l=b[d].shape||b[d];l=l.geometry||l;g=f.isArray(c)?c[d].style:c;switch(l.type){case "Point":this._$shapesContainer.geographics("drawPoint",this.toPixel(l.coordinates),g);break;case "LineString":this._$shapesContainer.geographics("drawLineString",this.toPixel(l.coordinates),
g);break;case "Polygon":j=[];f.each(l.coordinates,function(n){j[n]=m.toPixel(this)});this._$shapesContainer.geographics("drawPolygon",j,g);break;case "MultiPoint":for(e=0;e<l.coordinates;e++)this._$shapesContainer.geographics("drawPoint",this.toPixel(l.coordinates[e]),g);break;case "MultiLineString":for(e=0;e<l.coordinates;e++)this._$shapesContainer.geographics("drawLineString",this.toPixel(l.coordinates[e]),g);break;case "MultiPolygon":for(e=0;e<l.coordinates;e++){j=[];f.each(l.coordinates[e],function(n){j[n]=
m.toPixel(this)});this._$shapesContainer.geographics("drawPolygon",j,g)}break;case "GeometryCollection":m._drawGraphics(a,l.geometries,g)}}},_findMapSize:function(){for(var a={width:0,height:0},b=this._$elem;b.size()&&!(a.width>0&&a.height>0);){a={width:b.width(),height:b.height()};if(a.width<=0||a.height<=0)a={width:parseInt(b.css("width")),height:parseInt(b.css("height"))};b=b.parent()}return a},_forcePosition:function(a){var b=a.css("position");b!="relative"&&b!="absolute"&&b!="fixed"&&a.css("position",
"relative")},_getTiledPixelSize:function(a){var b=this._options.tilingScheme;if(b!=null){if(a===0)return b.pixelSizes!=null?b.pixelSizes[0]:b.basePixelSize;a=Math.round(a);a=Math.max(a,0);a=Math.min(a,(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-1);return b.pixelSizes!=null?b.pixelSizes[a]:b.basePixelSize/Math.pow(2,a)}else return NaN},_getTiledZoom:function(a){var b=this._options.tilingScheme;if(b.pixelSizes!=null){a=Math.floor(a*1E3);for(var c=(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-
1;c>=0;c--)if(Math.floor(b.pixelSizes[c]*1E3)>=a)return c;return 0}else return Math.max(Math.round(Math.log(b.basePixelSize/a)/Math.log(2)),0)},_getZoomCenterAndSize:function(a,b,c){if(this._options.tilingScheme){b=this._getTiledZoom(this._pixelSize)+b;b=this._getTiledPixelSize(b)}else{b=Math.pow(c,-b);b=this._pixelSize*b}c=b/this._pixelSize;a=this._toMap(a);c=[(this._center[0]-a[0])*c,(this._center[1]-a[1])*c];return{pixelSize:b,center:[a[0]+c[0],a[1]+c[1]]}},_mouseWheelFinish:function(){this._wheelTimer=
null;if(this._wheelLevel!=0){var a=this._getZoomCenterAndSize(this._anchor,this._wheelLevel,this._wheelZoomFactor);this._wheelLevel=0;this._setCenterAndSize(a.center,a.pixelSize,true,true)}else this._refresh()},_panEnd:function(){this._velocity=[this._velocity[0]>0?Math.floor(this._velocity[0]*this._friction[0]):Math.ceil(this._velocity[0]*this._friction[0]),this._velocity[1]>0?Math.floor(this._velocity[1]*this._friction[1]):Math.ceil(this._velocity[1]*this._friction[1])];if(Math.abs(this._velocity[0])<
4&&Math.abs(this._velocity[1])<4)this._panFinalize();else{this._current=[this._current[0]+this._velocity[0],this._current[1]+this._velocity[1]];this._panMove();setTimeout(f.proxy(this._panEnd,this),30)}},_panFinalize:function(){if(this._panning){this._velocity=[0,0];var a=-(this._current[0]-this._anchor[0])*this._pixelSize,b=(this._current[1]-this._anchor[1])*this._pixelSize;this._$shapesContainer.css({left:0,top:0});this._setCenterAndSize([this._center[0]+a,this._center[1]+b],this._pixelSize,true,
true);this._inOp=false;this._anchor=this._current;this._toolPan=this._panning=false;this._$eventTarget.css("cursor",this._options.cursors[this._options.mode])}},_panMove:function(){var a=this._current[0]-this._lastDrag[0],b=this._current[1]-this._lastDrag[1];if(this._toolPan||a>3||a<-3||b>3||b<-3){if(!this._toolPan){this._toolPan=true;this._$eventTarget.css("cursor",this._options.cursors.pan)}if(this._mouseDown)this._velocity=[a,b];if(a!=0||b!=0){this._panning=true;this._lastDrag=this._current;for(i=
0;i<this._options.services.length;i++){var c=this._options.services[i];f.geo._serviceTypes[c.type].interactivePan(this,c,a,b)}this._$shapesContainer.css({left:function(d,e){return parseInt(e)+a},top:function(d,e){return parseInt(e)+b}})}}},_refresh:function(){for(var a=0;a<this._options.services.length;a++){var b=this._options.services[a];!this._mouseDown&&f.geo._serviceTypes[b.type]!=null&&f.geo._serviceTypes[b.type].refresh(this,b)}if(this._$shapesContainer){this._$shapesContainer.geographics("clear");
this._graphicShapes.length>0&&this._drawGraphics(this._$shapesContainer,this._graphicShapes,this._graphicShapes)}},_setCenterAndSize:function(a,b,c,d){if(this._pixelSize!=b){this._$shapesContainer.geographics("clear");for(var e=0;e<this._options.services.length;e++){var l=this._options.services[e];f.geo._serviceTypes[l.type].interactiveScale(this,l,a,b)}}this._center=a;this._pixelSize=b;if(f.geo.proj){a=this._getBbox();a=f.geo.proj.toGeodetic([[a[0],a[1]],[a[2],a[3]]]);a=[a[0][0],a[0][1],a[1][0],
a[1][1]];this._options.bbox=a;this._options.center=f.geo.proj.toGeodetic([[this._center[0],this._center[1]]])[0]}else{this._options.bbox=this._getBbox();this._options.center=this._center}this._options.zoom=this._getZoom();c&&this._trigger("bboxchange",window.event,{bbox:this._options.bbox});d&&this._refresh()},_toMap:function(a,b,c){var d=f.isArray(a[0]);d||(a=[a]);b=b||this._center;c=c||this._pixelSize;var e=this._contentBounds.width,l=this._contentBounds.height,g=e/2*c;c=l/2*c;var j=[b[0]-g,b[1]-
c,b[0]+g,b[1]+c],m=f.geo._width(j)/e,n=f.geo._height(j)/l,v=[];f.each(a,function(u){v[u]=[j[0]+this[0]*m,j[3]-this[1]*n]});return d?v:v[0]},_toPixel:function(a,b,c){var d=f.isArray(a[0]);d||(a=[a]);b=b||this._center;c=c||this._pixelSize;var e=this._contentBounds.width,l=this._contentBounds.height,g=e/2*c;c=l/2*c;var j=[b[0]-g,b[1]-c,b[0]+g,b[1]+c],m=f.geo._width(j),n=f.geo._height(j),v=[];f.each(a,function(u){v[u]=[Math.round((this[0]-j[0])*e/m),Math.round((j[3]-this[1])*l/n)]});return d?v:v[0]},
_zoomTo:function(a,b,c,d){b=b<0?0:b;var e=this._getTiledPixelSize(b);if(isNaN(e)){b=f.geo._scaleBy(this._getBboxMax(),1/Math.pow(this._zoomFactor,b));b=Math.max(f.geo._width(b)/this._contentBounds.width,f.geo._height(b)/this._contentBounds.height);this._setCenterAndSize(a,b,c,d)}else this._setCenterAndSize(a,e,c,d)},_eventTarget_dblclick:function(a){this._panFinalize();f(a.currentTarget).offset();switch(this._options.mode){case "pan":this._trigger("dblclick",a,{type:"Point",coordinates:this.toMap(this._current)});
if(!a.isDefaultPrevented()){a=this._getZoomCenterAndSize(this._current,1,this._zoomFactor);this._setCenterAndSize(a.center,a.pixelSize,true,true)}}this._inOp=false},_eventTarget_touchstart:function(a){if(!(!this._supportTouch&&a.which!=1)){var b=f(a.currentTarget).offset();this._current=this._supportTouch?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];if(this._softDblClick){b=f.now();if(b-this._downDate<750){if(this._isTap){var c=
this._current[0]-this._anchor[0],d=this._current[1]-this._anchor[1];if(Math.sqrt(c*c+d*d)>10)this._isTap=false}this._isDbltap=this._isDbltap?false:this._isTap}else this._isDbltap=false;this._isTap=true;this._downDate=b}a.preventDefault();this._panFinalize();this._mouseWheelFinish();this._mouseDown=true;this._anchor=this._current;if(!this._inOp&&a.shiftKey){this._shiftZoom=true;this._$eventTarget.css("cursor",this._options.cursors.zoom)}else{this._inOp=true;switch(this._options.mode){case "pan":this._lastDrag=
this._current;a.currentTarget.setCapture&&a.currentTarget.setCapture()}}return false}},_dragTarget_touchmove:function(a){var b=this._$eventTarget.offset();b=this._supportTouch?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];if(!(b[0]==this._lastMove[0]&&b[1]==this._lastMove[1])){if(this._softDblClick)this._isDbltap=this._isTap=false;if(this._mouseDown){this._current=b;this._moveDate=f.now()}switch(this._shiftZoom?"zoom":
this._options.mode){case "pan":this._mouseDown||this._toolPan?this._panMove():this._trigger("move",a,{type:"Point",coordinates:this.toMap(b)})}this._lastMove=b}},_dragTarget_touchstop:function(a){!this._mouseDown&&q==7&&this._eventTarget_touchstart(a);var b=this._mouseDown,c=this._toolPan,d=this._$eventTarget.offset();d=this._supportTouch?[a.originalEvent.changedTouches[0].pageX-d.left,a.originalEvent.changedTouches[0].pageY-d.top]:[a.pageX-d.left,a.pageY-d.top];var e=this._shiftZoom?"zoom":this._options.mode;
this._$eventTarget.css("cursor",this._options.cursors[e]);this._shiftZoom=this._mouseDown=this._toolPan=false;document.releaseCapture&&document.releaseCapture();if(b){b=f.now();this._current=d;switch(e){case "pan":if(c)this._panEnd();else if(b-this._clickDate>100){this._trigger("click",a,{type:"Point",coordinates:this.toMap(d)});this._inOp=false}}this._clickDate=b;if(this._softDblClick&&this._isDbltap){this._isDbltap=this._isTap=false;this._$eventTarget.trigger("dblclick",a)}}},_eventTarget_mousewheel:function(a,
b){a.preventDefault();this._panFinalize();if(!this._mouseDown){if(b!=0){if(this._wheelTimer){window.clearTimeout(this._wheelTimer);this._wheelTimer=null}else{var c=f(a.currentTarget).offset();this._anchor=[a.pageX-c.left,a.pageY-c.top]}this._wheelLevel+=b;c=this._getZoomCenterAndSize(this._anchor,this._wheelLevel,this._wheelZoomFactor);this._$shapesContainer.geographics("clear");for(i=0;i<this._options.services.length;i++){var d=this._options.services[i];f.geo._serviceTypes[d.type].interactiveScale(this,
d,c.center,c.pixelSize)}var e=this;this._wheelTimer=window.setTimeout(function(){e._mouseWheelFinish()},1E3)}return false}}})})(jQuery);
(function(f,p){f.geo._serviceTypes.tiled=function(){var q={};return{create:function(a,b,c){if(!q[c.id]){q[c.id]={loadCount:0,reloadTiles:false,serviceContainer:null};b.append('<div data-geo-service="tiled" id="'+c.id+'" style="position:absolute; left:0; top:0; width:8px; height:8px; margin:0; padding:0; display:'+(c.visible===p||c.visible?"block":"none")+';"></div>');return q[c.id].serviceContainer=b.children(":last")}},destroy:function(a,b,c){q[c.id].serviceContainer.remove();delete q[c.id]},interactivePan:function(a,
b,c,d){if(q[b.id]){this._cancelUnloaded(a,b);q[b.id].serviceContainer.children().css({left:function(I,L){return parseInt(L)+c},top:function(I,L){return parseInt(L)+d}});if(b&&q[b.id]!=null&&(b.visible===p||b.visible)){var e=a.getPixelSize(),l=q[b.id],g=l.serviceContainer,j=g.children("[data-pixelSize='"+e+"']"),m=a._getContentBounds(),n=a.options.tilingScheme,v=n.tileWidth,u=n.tileHeight,z=m.width/2*e,A=m.height/2*e,y=j.position(),x=j.data("scaleOrigin").split(",");m=parseInt(x[0])-y.left;y=parseInt(x[1])-
y.top;var C=a._getCenter();x=[C[0]+m*e,C[1]-y*e];var F=Math.floor((x[0]-z-n.origin[0])/(e*v));m=Math.floor((n.origin[1]-(x[1]+A))/(e*u));y=Math.ceil((x[0]+z-n.origin[0])/(e*v));x=Math.ceil((n.origin[1]-(x[1]-A))/(e*u));var G=a._getBboxMax(),E=a._getTiledPixelSize(0),B=E/e,D=Math.floor((G[0]-n.origin[0])/(E*v))*B;G=Math.floor((n.origin[1]-G[3])/(E*u))*B;z=Math.round((n.origin[0]+D*v*e-(C[0]-z))/e);A=Math.round((C[1]+A-(n.origin[1]-G*u*e))/e);var J=b.opacity===p?1:b.opacity;for(C=F;C<y;C++)for(F=m;F<
x;F++){E=""+C+","+F;B=j.children("[data-tile='"+E+"']").removeAttr("data-dirty");if(B.size()===0){var H=[n.origin[0]+C*v*e,n.origin[1]-F*u*e],r=[n.origin[0]+((C+1)*v-1)*e,n.origin[1]-((F+1)*u-1)*e];H=b.getUrl({bbox:[H[0],H[1],r[0],r[1]],width:v,height:u,zoom:a._getZoom(),tile:{row:F,column:C},index:Math.abs(F+C)});l.loadCount++;if(l.reloadTiles&&B.size()>0)B.attr("src",H);else{B="<img style='position:absolute; left:"+((C-D)*100+(z-z%v)/v*100)+"%; top:"+((F-G)*100+(A-A%u)/u*100)+"%; ";if(f("body")[0].filters===
p)B+="width: 100%; height: 100%;";B+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+E+"' />";j.append(B);B=j.children(":last");B.load(function(I){J<1?f(I.target).fadeTo(0,J):f(I.target).show();l.loadCount--;if(l.loadCount<=0){g.children(":not([data-pixelSize='"+e+"'])").remove();l.loadCount=0}}).error(function(I){f(I.target).remove();l.loadCount--;if(l.loadCount<=0){g.children(":not([data-pixelSize='"+
e+"'])").remove();l.loadCount=0}}).attr("src",H)}}}}}},interactiveScale:function(a,b,c,d){if(q[b.id]){this._cancelUnloaded(a,b);var e=a.options.tilingScheme,l=e.tileWidth,g=e.tileHeight;q[b.id].serviceContainer.children().each(function(){var j=f(this),m=j.attr("data-pixelSize")/d;m=Math.round(m*1E3)/1E3;var n=j.data("scaleOrigin").split(",");n=a._toMap([n[0],n[1]]);n=a._toPixel(n,c,d);j.css({left:Math.round(n[0])+"px",top:Math.round(n[1])+"px",width:l*m,height:g*m});f("body")[0].filters!==p&&j.children().each(function(){f(this).css("filter",
"progid:DXImageTransform.Microsoft.Matrix(FilterType=bilinear,M11="+m+",M22="+m+",sizingmethod='auto expand')")})})}},refresh:function(a,b){if(b&&q[b.id]&&(b.visible===p||b.visible)){this._cancelUnloaded(a,b);var c=a._getBbox(),d=a.getPixelSize(),e=q[b.id],l=e.serviceContainer;a._getContentBounds();var g=a.options.tilingScheme,j=g.tileWidth,m=g.tileHeight,n=Math.floor((c[0]-g.origin[0])/(d*j)),v=Math.floor((g.origin[1]-c[3])/(d*m)),u=Math.ceil((c[2]-g.origin[0])/(d*j)),z=Math.ceil((g.origin[1]-c[1])/
(d*m)),A=a._getBboxMax(),y=a._getTiledPixelSize(0),x=y/d,C=Math.floor((A[0]-g.origin[0])/(y*j))*x,F=Math.floor((g.origin[1]-A[3])/(y*m))*x,G=Math.round((g.origin[0]+C*j*d-c[0])/d),E=Math.round((c[3]-(g.origin[1]-F*m*d))/d);c=l.children().show();A=c.filter("[data-pixelSize='"+d+"']").appendTo(l);var B=b.opacity===p?1:b.opacity;e.reloadTiles&&c.find("img").attr("data-dirty","true");if(A.size()){A.css({left:G%j+"px",top:E%m+"px"}).data("scaleOrigin",G%j+","+E%m);A.children().each(function(){var r=f(this),
I=r.attr("data-tile").split(",");r.css({left:Math.round((parseInt(I[0])-C)*100+(G-G%j)/j*100)+"%",top:Math.round((parseInt(I[1])-F)*100+(E-E%m)/m*100)+"%"});B<1&&r.fadeTo(0,B)})}else{l.append("<div style='position:absolute; left:"+G%j+"px; top:"+E%m+"px; width:"+j+"px; height:"+m+"px; margin:0; padding:0;' data-pixelSize='"+d+"'></div>");A=l.children(":last").data("scaleOrigin",G%j+","+E%m)}for(n=n;n<u;n++)for(y=v;y<z;y++){x=""+n+","+y;var D=A.children("[data-tile='"+x+"']").removeAttr("data-dirty");
if(D.size()===0||e.reloadTiles){var J=[g.origin[0]+n*j*d,g.origin[1]-y*m*d],H=[g.origin[0]+((n+1)*j-1)*d,g.origin[1]-((y+1)*m-1)*d];J=b.getUrl({bbox:[J[0],J[1],H[0],H[1]],width:j,height:m,zoom:a._getZoom(),tile:{row:y,column:n},index:Math.abs(y+n)});e.loadCount++;if(e.reloadTiles&&D.size()>0)D.attr("src",J);else{D="<img style='position:absolute; left:"+((n-C)*100+(G-G%j)/j*100)+"%; top:"+((y-F)*100+(E-E%m)/m*100)+"%; ";if(f("body")[0].filters===p)D+="width: 100%; height: 100%;";D+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+
x+"' />";A.append(D);D=A.children(":last");D.load(function(r){B<1?f(r.target).fadeTo(0,B):f(r.target).show();e.loadCount--;if(e.loadCount<=0){l.children(":not([data-pixelSize='"+d+"'])").remove();e.loadCount=0}}).error(function(r){f(r.target).remove();e.loadCount--;if(e.loadCount<=0){l.children(":not([data-pixelSize='"+d+"'])").remove();e.loadCount=0}}).attr("src",J)}}}c.find("[data-dirty]").remove();e.reloadTiles=false}},opacity:function(a,b){q[b.id].serviceContainer.find("img").stop(true).fadeTo("fast",
b.opacity)},toggle:function(a,b){q[b.id].serviceContainer.css("display",b.visible?"block":"none")},_cancelUnloaded:function(a,b){var c=q[b.id];if(c&&c.loadCount>0)for(c.serviceContainer.find("img:hidden").remove();c.loadCount>0;)c.loadCount--}}}()})(jQuery);
(function(f,p){f.geo._serviceTypes.shingled=function(){var q={};return{create:function(a,b,c){if(!q[c.id]){q[c.id]={loadCount:0};b.append('<div data-geo-service="shingled" id="'+c.id+'" style="position:absolute; left:0; top:0; width:16px; height:16px; margin:0; padding:0; display:'+(c.visible===p||c.visible?"block":"none")+';"></div>');return q[c.id].serviceContainer=b.children(":last")}},destroy:function(a,b,c){q[c.id].serviceContainer.remove();delete q[c.id]},interactivePan:function(a,b,c,d){if(q[b.id]){this._cancelUnloaded(a,
b);b=q[b.id].serviceContainer;a=a.getPixelSize();a=b.children("[data-pixelSize='"+a+"']");b=a.children("div");if(!b.length){a.children("img").wrap('<div style="position:absolute; left:0; top:0; width:100%; height:100%;"></div>');b=a.children("div")}b.css({left:function(e,l){return parseInt(l)+c},top:function(e,l){return parseInt(l)+d}})}},interactiveScale:function(a,b,c,d){if(q[b.id]){this._cancelUnloaded(a,b);b=q[b.id].serviceContainer;a=a._getContentBounds();var e=a.width,l=a.height,g=e/2,j=l/2;
b.children().each(function(){var m=f(this),n=m.attr("data-pixelSize"),v=n/d;m.css({width:e*v,height:l*v}).children("img").each(function(){var u=f(this),z=u.data("center");u.css({left:(Math.round((z[0]-c[0])/n)-g)*v+"px",top:(Math.round((c[1]-z[1])/n)-j)*v+"px"})})})}},refresh:function(a,b){if(b&&q[b.id]&&(b.visible===p||b.visible)){this._cancelUnloaded(a,b);var c=a._getBbox(),d=a.getPixelSize(),e=q[b.id],l=e.serviceContainer,g=a._getContentBounds(),j=g.width,m=g.height,n=j/2,v=m/2;g=l.children('[data-pixelSize="'+
d+'"]');var u=b.opacity===p?1:b.opacity;if(!g.size()){l.append('<div style="position:absolute; left:'+n+"px; top:"+v+"px; width:"+j+"px; height:"+m+'px; margin:0; padding:0;" data-pixelSize="'+d+'"></div>');g=l.children(":last")}g.children("img").each(function(){var z=f(this),A=z.data("center"),y=a._getCenter();z.css({left:Math.round((A[0]-y[0])/d)-n+"px",top:Math.round((y[1]-A[1])/d)-v+"px"})});u<1&&l.find("img").attr("data-keepAlive","0");c=b.getUrl({bbox:c,width:j,height:m,zoom:a._getZoom(),tile:null,
index:0});e.loadCount++;g.append('<img style="position:absolute; left:-'+n+"px; top:-"+v+'px; width:100%; height:100%; margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;" unselectable="on" />');g.children(":last").data("center",a._getCenter()).load(function(z){u<1?f(z.target).fadeTo(0,u):f(z.target).show();e.loadCount--;if(e.loadCount<=0){l.children(':not([data-pixelSize="'+d+'"])').remove();z=l.find('[data-pixelSize="'+d+
'"]>div');if(z.size()>0){var A=z.position();z.children("img").each(function(){var y=f(this),x=A.left+parseInt(y.css("left")),C=A.top+parseInt(y.css("top"));y.css({left:x+"px",top:C+"px"})}).unwrap();z.remove()}e.loadCount=0}}).error(function(z){f(z.target).remove();e.loadCount--;if(e.loadCount<=0){l.children(":not([data-pixelSize='"+d+"'])").remove();e.loadCount=0}}).attr("src",c)}},opacity:function(a,b){q[b.id].serviceContainer.find("img").stop(true).fadeTo("fast",b.opacity)},_cancelUnloaded:function(a,
b){var c=q[b.id];if(c&&c.loadCount>0)for(c.serviceContainer.find("img:hidden").remove();c.loadCount>0;)c.loadCount--}}}()})(jQuery);
