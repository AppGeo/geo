document.createElement("canvas").getContext||function(){function c(){return this.context_||(this.context_=new A(this))}function C(f,k){var o=ia.call(arguments,2);return function(){return f.apply(k,o.concat(ia.call(arguments)))}}function G(f){f.namespaces.g_vml_||f.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");f.namespaces.g_o_||f.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!f.styleSheets.ex_canvas_){f=f.createStyleSheet();f.owningElement.id=
"ex_canvas_";f.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function e(f){var k=f.srcElement;switch(f.propertyName){case "width":k.getContext().clearRect();k.style.width=k.attributes.width.nodeValue+"px";k.firstChild.style.width=k.clientWidth+"px";break;case "height":k.getContext().clearRect();k.style.height=k.attributes.height.nodeValue+"px";k.firstChild.style.height=k.clientHeight+"px"}}function g(f){f=f.srcElement;if(f.firstChild){f.firstChild.style.width=
f.clientWidth+"px";f.firstChild.style.height=f.clientHeight+"px"}}function j(){return[[1,0,0],[0,1,0],[0,0,1]]}function h(f,k){for(var o=j(),v=0;v<3;v++)for(var y=0;y<3;y++){for(var w=0,u=0;u<3;u++)w+=f[v][u]*k[u][y];o[v][y]=w}return o}function n(f,k){k.fillStyle=f.fillStyle;k.lineCap=f.lineCap;k.lineJoin=f.lineJoin;k.lineWidth=f.lineWidth;k.miterLimit=f.miterLimit;k.shadowBlur=f.shadowBlur;k.shadowColor=f.shadowColor;k.shadowOffsetX=f.shadowOffsetX;k.shadowOffsetY=f.shadowOffsetY;k.strokeStyle=f.strokeStyle;
k.globalAlpha=f.globalAlpha;k.font=f.font;k.textAlign=f.textAlign;k.textBaseline=f.textBaseline;k.arcScaleX_=f.arcScaleX_;k.arcScaleY_=f.arcScaleY_;k.lineScale_=f.lineScale_}function t(f){var k=f.indexOf("(",3),o=f.indexOf(")",k+1);k=f.substring(k+1,o).split(",");if(k.length!=4||f.charAt(3)!="a")k[3]=1;return k}function l(f,k,o){return Math.min(o,Math.max(k,f))}function m(f,k,o){o<0&&o++;o>1&&o--;return 6*o<1?f+(k-f)*6*o:2*o<1?k:3*o<2?f+(k-f)*(2/3-o)*6:f}function s(f){if(f in fa)return fa[f];var k,
o=1;f=String(f);if(f.charAt(0)=="#")k=f;else if(/^rgb/.test(f)){o=t(f);k="#";for(var v,y=0;y<3;y++){v=o[y].indexOf("%")!=-1?Math.floor(parseFloat(o[y])/100*255):+o[y];k+=ga[l(v,0,255)]}o=+o[3]}else if(/^hsl/.test(f)){y=o=t(f);k=parseFloat(y[0])/360%360;k<0&&k++;v=l(parseFloat(y[1])/100,0,1);y=l(parseFloat(y[2])/100,0,1);if(v==0)v=y=k=y;else{var w=y<0.5?y*(1+v):y+v-y*v,u=2*y-w;v=m(u,w,k+1/3);y=m(u,w,k);k=m(u,w,k-1/3)}k="#"+ga[Math.floor(v*255)]+ga[Math.floor(y*255)]+ga[Math.floor(k*255)];o=o[3]}else k=
f;return fa[f]={color:k,alpha:o}}function A(f){this.m_=j();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=ba*1;this.globalAlpha=1;this.canvas=f;var k="width:"+f.clientWidth+"px;height:"+f.clientHeight+"px;overflow:hidden;position:absolute",o=f.ownerDocument.createElement("div");o.style.cssText=k;f.appendChild(o);k=o.cloneNode(false);k.style.backgroundColor="red";k.style.filter="alpha(opacity=0)";
f.appendChild(k);this.element_=o;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function R(f,k,o,v){f.currentPath_.push({type:"bezierCurveTo",cp1x:k.x,cp1y:k.y,cp2x:o.x,cp2y:o.y,x:v.x,y:v.y});f.currentX_=v.x;f.currentY_=v.y}function K(f,k,o){f=f.m_;return{x:ba*(k*f[0][0]+o*f[1][0]+f[2][0])-ca,y:ba*(k*f[0][1]+o*f[1][1]+f[2][1])-ca}}function Z(f,k,o){if(isFinite(k[0][0])&&isFinite(k[0][1])&&isFinite(k[1][0])&&isFinite(k[1][1])&&isFinite(k[2][0])&&isFinite(k[2][1])){f.m_=k;if(o)f.lineScale_=na(N(k[0][0]*
k[1][1]-k[0][1]*k[1][0]))}}function S(f){this.code=this[f];this.message=f+": DOM Exception "+this.code}var T=Math,H=T.round,ja=T.sin,Y=T.cos,N=T.abs,na=T.sqrt,ba=10,ca=ba/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var ia=Array.prototype.slice;G(document);T={init:function(f){f=f||document;f.createElement("canvas");f.attachEvent("onreadystatechange",C(this.init_,this,f))},init_:function(f){f=f.getElementsByTagName("canvas");for(var k=0;k<f.length;k++)this.initElement(f[k])},initElement:function(f){if(!f.getContext){f.getContext=
c;G(f.ownerDocument);f.innerHTML="";f.attachEvent("onpropertychange",e);f.attachEvent("onresize",g);var k=f.attributes;if(k.width&&k.width.specified)f.style.width=k.width.nodeValue+"px";else f.width=f.clientWidth;if(k.height&&k.height.specified)f.style.height=k.height.nodeValue+"px";else f.height=f.clientHeight}return f}};T.init();for(var ga=[],E=0;E<16;E++)for(var O=0;O<16;O++)ga[E*16+O]=E.toString(16)+O.toString(16);var fa={},oa={butt:"flat",round:"round"};E=A.prototype;E.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);
this.textMeasureEl_=null}this.element_.innerHTML=""};E.beginPath=function(){this.currentPath_=[]};E.moveTo=function(f,k){var o=K(this,f,k);this.currentPath_.push({type:"moveTo",x:o.x,y:o.y});this.currentX_=o.x;this.currentY_=o.y};E.lineTo=function(f,k){var o=K(this,f,k);this.currentPath_.push({type:"lineTo",x:o.x,y:o.y});this.currentX_=o.x;this.currentY_=o.y};E.bezierCurveTo=function(f,k,o,v,y,w){y=K(this,y,w);f=K(this,f,k);o=K(this,o,v);R(this,f,o,y)};E.quadraticCurveTo=function(f,k,o,v){f=K(this,
f,k);o=K(this,o,v);v={x:this.currentX_+2/3*(f.x-this.currentX_),y:this.currentY_+2/3*(f.y-this.currentY_)};R(this,v,{x:v.x+(o.x-this.currentX_)/3,y:v.y+(o.y-this.currentY_)/3},o)};E.arc=function(f,k,o,v,y,w){o*=ba;var u=w?"at":"wa",ka=f+Y(v)*o-ca,a=k+ja(v)*o-ca;v=f+Y(y)*o-ca;y=k+ja(y)*o-ca;if(ka==v&&!w)ka+=0.125;f=K(this,f,k);ka=K(this,ka,a);v=K(this,v,y);this.currentPath_.push({type:u,x:f.x,y:f.y,radius:o,xStart:ka.x,yStart:ka.y,xEnd:v.x,yEnd:v.y})};E.stroke=function(f){var k=[];k.push("<g_vml_:shape",
' filled="',!!f,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',ba*10,",",ba*10,'"',' stroked="',!f,'"',' path="');for(var o={x:null,y:null},v={x:null,y:null},y=0;y<this.currentPath_.length;y++){var w=this.currentPath_[y];switch(w.type){case "moveTo":k.push(" m ",H(w.x),",",H(w.y));break;case "lineTo":k.push(" l ",H(w.x),",",H(w.y));break;case "close":k.push(" x ");w=null;break;case "bezierCurveTo":k.push(" c ",H(w.cp1x),",",H(w.cp1y),",",H(w.cp2x),
",",H(w.cp2y),",",H(w.x),",",H(w.y));break;case "at":case "wa":k.push(" ",w.type," ",H(w.x-this.arcScaleX_*w.radius),",",H(w.y-this.arcScaleY_*w.radius)," ",H(w.x+this.arcScaleX_*w.radius),",",H(w.y+this.arcScaleY_*w.radius)," ",H(w.xStart),",",H(w.yStart)," ",H(w.xEnd),",",H(w.yEnd))}if(w){if(o.x==null||w.x<o.x)o.x=w.x;if(v.x==null||w.x>v.x)v.x=w.x;if(o.y==null||w.y<o.y)o.y=w.y;if(v.y==null||w.y>v.y)v.y=w.y}}k.push(' ">');if(f){f=s(this.fillStyle);k.push('<g_vml_:fill color="',f.color,'" opacity="',
f.alpha*this.globalAlpha,'" />')}else{o=s(this.strokeStyle);f=o.color;o=o.alpha*this.globalAlpha;v=this.lineScale_*this.lineWidth;if(v<1)o*=v;k.push("<g_vml_:stroke",' opacity="',o,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',oa[this.lineCap]||"square",'"',' weight="',v,'px"',' color="',f,'" />')}k.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",k.join(""))};E.fill=function(){this.stroke(true)};E.closePath=function(){this.currentPath_.push({type:"close"})};
E.save=function(){var f={};n(this,f);this.aStack_.push(f);this.mStack_.push(this.m_);this.m_=h(j(),this.m_)};E.restore=function(){if(this.aStack_.length){n(this.aStack_.pop(),this);this.m_=this.mStack_.pop()}};E.translate=function(f,k){Z(this,h([[1,0,0],[0,1,0],[f,k,1]],this.m_),false)};E.scale=function(f,k){this.arcScaleX_*=f;this.arcScaleY_*=k;Z(this,h([[f,0,0],[0,k,0],[0,0,1]],this.m_),true)};E=S.prototype=Error();E.INDEX_SIZE_ERR=1;E.DOMSTRING_SIZE_ERR=2;E.HIERARCHY_REQUEST_ERR=3;E.WRONG_DOCUMENT_ERR=
4;E.INVALID_CHARACTER_ERR=5;E.NO_DATA_ALLOWED_ERR=6;E.NO_MODIFICATION_ALLOWED_ERR=7;E.NOT_FOUND_ERR=8;E.NOT_SUPPORTED_ERR=9;E.INUSE_ATTRIBUTE_ERR=10;E.INVALID_STATE_ERR=11;E.SYNTAX_ERR=12;E.INVALID_MODIFICATION_ERR=13;E.NAMESPACE_ERR=14;E.INVALID_ACCESS_ERR=15;E.VALIDATION_ERR=16;E.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=T;CanvasRenderingContext2D=A;DOMException=S}();
(function(c){function C(e){var g=[].slice.call(arguments,1),j=0;e=c.event.fix(e||window.event);e.type="mousewheel";if(e.wheelDelta)j=e.wheelDelta/120;if(e.detail)j=-e.detail/3;g.unshift(e,j);return c.event.handle.apply(this,g)}var G=["DOMMouseScroll","mousewheel"];c.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=G.length;e;)this.addEventListener(G[--e],C,false);else this.onmousewheel=C},teardown:function(){if(this.removeEventListener)for(var e=G.length;e;)this.removeEventListener(G[--e],
C,false);else this.onmousewheel=null}};c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);
$.widget||function(c,C){var G=Array.prototype.slice,e=c.cleanData;c.cleanData=function(g){for(var j=0,h;(h=g[j])!=null;j++)c(h).triggerHandler("remove");e(g)};c.widget=function(g,j,h){var n=g.split(".")[0],t;g=g.split(".")[1];t=n+"-"+g;if(!h){h=j;j=c.Widget}c.expr[":"][t]=function(m){return!!c.data(m,g)};c[n]=c[n]||{};c[n][g]=c.extend(function(m,s){if(!this._createWidget)return new c[n][g](m,s);arguments.length&&this._createWidget(m,s)},c[n][g]);var l=new j;l.options=c.extend(true,{},l.options);c.each(h,
function(m,s){if(c.isFunction(s))h[m]=function(){var A=function(K){return j.prototype[K].apply(this,G.call(arguments,1))},R=function(K,Z){return j.prototype[K].apply(this,Z)};return function(){var K=this._super,Z=this._superApply,S;this._super=A;this._superApply=R;S=s.apply(this,arguments);this._super=K;this._superApply=Z;return S}}()});c[n][g].prototype=c.extend(true,l,{namespace:n,widgetName:g,widgetEventPrefix:g,widgetBaseClass:t},h);c.widget.bridge(g,c[n][g])};c.widget.bridge=function(g,j){c.fn[g]=
function(h){var n=typeof h==="string",t=G.call(arguments,1),l=this;h=!n&&t.length?c.extend.apply(null,[true,h].concat(t)):h;n?this.each(function(){var m=c.data(this,g);if(!m)return c.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+h+"'");if(!c.isFunction(m[h])||h.charAt(0)==="_")return c.error("no such method '"+h+"' for "+g+" widget instance");var s=m[h].apply(m,t);if(s!==m&&s!==C){l=s;return false}}):this.each(function(){var m=c.data(this,g);m?m.option(h||
{})._init():j(h,this)});return l}};c.Widget=function(g,j){if(!this._createWidget)return new c[namespace][name](g,j);arguments.length&&this._createWidget(g,j)};c.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false},_createWidget:function(g,j){j=c(j||this.defaultElement||this)[0];this.element=c(j);this.options=c.extend(true,{},this.options,this._getCreateOptions(),g);this.bindings=c();this.hoverable=c();this.focusable=c();if(j!==this){c.data(j,this.widgetName,
this);this._bind({remove:"destroy"})}this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return c.metadata&&c.metadata.get(this.element[0])[this.widgetName]},_create:c.noop,_init:c.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus")},_destroy:c.noop,widget:function(){return this.element},option:function(g,j){var h=g;if(arguments.length===0)return c.extend({},this.options);if(typeof g==="string"){if(j===C)return this.options[g];h={};h[g]=j}this._setOptions(h);return this},_setOptions:function(g){var j=this;c.each(g,function(h,n){j._setOption(h,n)});return this},_setOption:function(g,j){this.options[g]=j;if(g==="disabled"){this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",
!!j).attr("aria-disabled",j);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_bind:function(g,j){if(j){g=c(g);this.bindings=this.bindings.add(g)}else{j=g;g=this.element}var h=this;c.each(j,function(n,t){g.bind(n+"."+h.widgetName,function(){if(!(h.options.disabled===true||c(this).hasClass("ui-state-disabled")))return(typeof t===
"string"?h[t]:t).apply(h,arguments)})})},_hoverable:function(g){this.hoverable=this.hoverable.add(g);this._bind(g,{mouseenter:function(j){c(j.currentTarget).addClass("ui-state-hover")},mouseleave:function(j){c(j.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(g){this.focusable=this.focusable.add(g);this._bind(g,{focusin:function(j){c(j.currentTarget).addClass("ui-state-focus")},focusout:function(j){c(j.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(g,j,h){var n=
this.options[g];j=c.Event(j);j.type=(g===this.widgetEventPrefix?g:this.widgetEventPrefix+g).toLowerCase();h=h||{};if(j.originalEvent){g=c.event.props.length;for(var t;g;){t=c.event.props[--g];j[t]=j.originalEvent[t]}}this.element.trigger(j,h);h=c.isArray(h)?[j].concat(h):[j,h];return!(c.isFunction(n)&&n.apply(this.element[0],h)===false||j.isDefaultPrevented())}}}(jQuery);
(function(c){var C=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY;c.geo={_allCoordinates:function(e){e=this._flatten(e);for(var g=0,j=[];g<e.length;g++){var h=e[g].coordinates,n=c.isArray(h[0]),t=n&&c.isArray(h[0][0]),l;if(!(t&&c.isArray(h[0][0][0]))){if(!t){n||(h=[h]);h=[h]}h=[h]}for(n=0;n<h.length;n++)for(t=0;t<h[n].length;t++)for(l=0;l<h[n][t].length;l++)j.push(h[n][t][l])}return j},_center:function(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]},_expandBy:function(e,g,j){return[e[0]-g,e[1]-j,e[2]+
g,e[3]+j]},_height:function(e){return e[3]-e[1]},_reaspect:function(e,g){var j=this._width(e),h=this._height(e),n=this._center(e);if(j==0||h==0||g<=0)return e;if(j/h>g){j=j/2;h=j/g}else{h=h/2;j=h*g}return[n[0]-j,n[1]-h,n[0]+j,n[1]+h]},_scaleBy:function(e,g){var j=this._center(e),h=(e[2]-e[0])*g/2,n=(e[3]-e[1])*g/2;return[j[0]-h,j[1]-n,j[0]+h,j[1]+n]},_width:function(e){return e[2]-e[0]},_bbox:function(e){var g=c.data(e,"geoBbox");if(!g)if(e.bbox)c.data(e,"geoBbox",g=e.bbox);else{g=[C,C,G,G];for(var j=
this._allCoordinates(e),h=0;h<j.length;h++){g[0]=Math.min(j[h][0],g[0]);g[1]=Math.min(j[h][1],g[1]);g[2]=Math.max(j[h][0],g[2]);g[3]=Math.max(j[h][1],g[3])}c.data(e,"geoBbox",g)}return g},_contains:function(e,g){if(e.type!="Polygon")return false;switch(g.type){case "Point":return this._containsPolygonPoint(e.coordinates,g.coordinates);case "LineString":return this._containsPolygonLineString(e.coordinates,g.coordinates);case "Polygon":return this._containsPolygonLineString(e.coordinates,g.coordinates[0])}},
_containsPolygonPoint:function(e,g){if(e.length==0||e[0].length<4)return false;for(var j=0,h=e[0][0],n=1,t;n<e[0].length;n++){t=e[0][n];if(h[1]<=g[1]&&g[1]<t[1]||t[1]<=g[1]&&g[1]<h[1]&&(g[0]<h[0]||g[0]<t[0])){h=h[0]+(t[0]-h[0])*(g[1]-h[1])/(t[1]-h[1]);h>g[0]&&j++}h=t}return j%2==1},_containsPolygonLineString:function(e,g){for(var j=0;j<g.length;j++)if(!this._containsPolygonPoint(e,g[j]))return false;return true},_distance:function(e,g){var j=c.isArray(e)?e:e.coordinates,h=c.isArray(g)?g:g.coordinates;
j=c.geo.proj?c.geo.proj.fromGeodetic(j):j;h=c.geo.proj?c.geo.proj.fromGeodetic(h):h;switch(e.type){case "Point":switch(g.type){case "Point":return this._distancePointPoint(h,j);case "LineString":return this._distanceLineStringPoint(h,j);case "Polygon":return this._containsPolygonPoint(h,j)?0:this._distanceLineStringPoint(h[0],j);default:throw Error("not implemented");}case "LineString":switch(g.type){case "Point":return this._distanceLineStringPoint(j,h);case "LineString":return this._distanceLineStringLineString(j,
h);case "Polygon":return this._containsPolygonLineString(h,j)?0:this._distanceLineStringLineString(h[0],j);default:throw Error("not implemented");}case "Polygon":switch(g.type){case "Point":return this._containsPolygonPoint(j,h)?0:this._distanceLineStringPoint(j[0],h);case "LineString":return this._containsPolygonLineString(j,h)?0:this._distanceLineStringLineString(j[0],h);case "Polygon":return this._containsPolygonLineString(j,h[0])?0:this._distanceLineStringLineString(j[0],h[0]);default:throw Error("not implemented");
}}},_distancePointPoint:function(e,g){var j=g[0]-e[0],h=g[1]-e[1];return Math.sqrt(j*j+h*h)},_distanceLineStringPoint:function(e,g){var j=C;if(e.length>0){var h=e[0],n=g[0]-h[0],t=g[1]-h[1];if(e.length==1)return Math.sqrt(n*n+t*t);else for(var l=1;l<e.length;l++){var m=e[l],s=g[0]-m[0],A=g[1]-m[1];h=this._distanceSegmentPoint(m[0]-h[0],m[1]-h[1],n,t,s,A);if(h==0)return 0;if(h<j)j=h;h=m;n=s;t=A}}return Math.sqrt(j)},_distanceSegmentPoint:function(e,g,j,h,n,t){var l=e*j+g*h;if(l<=0)return j*j+h*h;e=
e*e+g*g;if(l>=e)return n*n+t*t;return j*j+h*h-l*l/e},_distanceLineStringLineString:function(e,g){for(var j=C,h=0;h<g;h++)j=Math.min(j,this._distanceLineStringPoint(e,g[h]));return j},_flatten:function(e){var g=[];switch(e.type){case "Feature":c.merge(g,this._flatten(e.geometry));break;case "GeometryCollection":for(curGeom=0;curGeom<e.geometries.length;curGeom++)c.merge(g,this._flatten(e.geometries[curGeom]));break;default:g[0]=e}return g},proj:function(){return{fromGeodeticPos:function(e){return[6378137*
e[0]*0.017453292519943295,6378137*Math.log(Math.tan(0.7853981633974483+e[1]*0.017453292519943295/2))]},fromGeodetic:function(e){var g=c.isArray(e[0]),j=g&&c.isArray(e[0][0]),h=j&&c.isArray(e[0][0][0]),n=[[[]]],t=this.fromGeodeticPos;if(!h){if(!j){g||(e=[e]);e=[e]}e=[e]}c.each(e,function(l){c.each(this,function(m){c.each(this,function(s){n[l][m][s]=t(this)})})});return h?n:j?n[0]:g?n[0][0]:n[0][0][0]},toGeodeticPos:function(e){return[e[0]/6378137*57.29577951308232,(1.5707963267948966-2*Math.atan(1/
Math.exp(e[1]/6378137)))*57.29577951308232]},toGeodetic:function(e){var g=c.isArray(e[0]),j=g&&c.isArray(e[0][0]),h=j&&c.isArray(e[0][0][0]),n=[[[]]],t=this.toGeodeticPos;if(!h){if(!j){g||(e=[e]);e=[e]}e=[e]}c.each(e,function(l){c.each(this,function(m){c.each(this,function(s){n[l][m][s]=t(this)})})});return h?n:j?n[0]:g?n[0][0]:n[0][0][0]}}}()}})(jQuery,this);
(function(c){var C,G,e=true,g,j,h,n,t=function(){for(var l=5,m=document.createElement("div"),s=m.all||[];m.innerHTML="<!--[if gt IE "+ ++l+"]><br><![endif]--\>",s[0];);return l>6?l:!l}();c.widget("geo.geographics",{options:{style:{borderRadius:"8px",color:"#7f0000",fillOpacity:0.2,height:"8px",opacity:1,strokeOpacity:1,strokeWidth:"2px",visibility:"visible",width:"8px"}},_create:function(){C=this.element;G=this.options;C.css({display:"inline-block",overflow:"hidden",textAlign:"left"});C.css("position")==
"static"&&C.css("position","relative");g=C.width();j=C.height();if(!(g&&j)){g=parseInt(C.css("width"));j=parseInt(C.css("height"))}if(document.createElement("canvas").getContext){C.append('<canvas width="'+g+'" height="'+j+'" style="position:absolute; left:0; top:0; width:'+g+"px; height:"+j+'px;"></canvas>');h=C.children(":last");n=h[0].getContext("2d")}else if(t<=8){e=false;C.append('<div width="'+g+'" height="'+j+'" style="position:absolute; left:0; top:0; width:'+g+"px; height:"+j+'px; margin:0; padding:0;"></div>');
h=C.children(":last");G_vmlCanvasManager.initElement(h[0]);n=h[0].getContext("2d");h.children().css({backgroundColor:"transparent",width:g,height:j})}},_setOption:function(l,m){if(l=="style")m=c.extend({},G.style,m);c.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){c.Widget.prototype.destroy.apply(this,arguments);C.html("")},clear:function(){n.clearRect(0,0,g,j)},drawArc:function(l,m,s,A){A=this._getGraphicStyle(A);if(A.visibility!="hidden"&&A.opacity>0&&A.widthValue>0&&A.heightValue>
0){var R=Math.min(A.widthValue,A.heightValue)/2;m=m*Math.PI/180;s=s*Math.PI/180;n.save();n.translate(l[0],l[1]);A.widthValue>A.heightValue?n.scale(A.widthValue/A.heightValue,1):n.scale(1,A.heightValue/A.widthValue);n.beginPath();n.arc(0,0,R,m,s,false);e&&n.restore();if(A.doFill){n.fillStyle=A.fill;n.globalAlpha=A.opacity*A.fillOpacity;n.fill()}if(A.doStroke){n.lineJoin="round";n.lineWidth=A.strokeWidthValue;n.strokeStyle=A.stroke;n.globalAlpha=A.opacity*A.strokeOpacity;n.stroke()}e||n.restore()}},
drawPoint:function(l,m){m=this._getGraphicStyle(m);if(m.widthValue==m.heightValue&&m.heightValue==m.borderRadiusValue)this.drawArc(l,0,360,m);else if(m.visibility!="hidden"&&m.opacity>0){m.borderRadiusValue=Math.min(Math.min(m.widthValue,m.heightValue)/2,m.borderRadiusValue);l[0]-=m.widthValue/2;l[1]-=m.heightValue/2;n.beginPath();n.moveTo(l[0]+m.borderRadiusValue,l[1]);n.lineTo(l[0]+m.widthValue-m.borderRadiusValue,l[1]);n.quadraticCurveTo(l[0]+m.widthValue,l[1],l[0]+m.widthValue,l[1]+m.borderRadiusValue);
n.lineTo(l[0]+m.widthValue,l[1]+m.heightValue-m.borderRadiusValue);n.quadraticCurveTo(l[0]+m.widthValue,l[1]+m.heightValue,l[0]+m.widthValue-m.borderRadiusValue,l[1]+m.heightValue);n.lineTo(l[0]+m.borderRadiusValue,l[1]+m.heightValue);n.quadraticCurveTo(l[0],l[1]+m.heightValue,l[0],l[1]+m.heightValue-m.borderRadiusValue);n.lineTo(l[0],l[1]+m.borderRadiusValue);n.quadraticCurveTo(l[0],l[1],l[0]+m.borderRadiusValue,l[1]);n.closePath();if(m.doFill){n.fillStyle=m.fill;n.globalAlpha=m.opacity*m.fillOpacity;
n.fill()}if(m.doStroke){n.lineJoin="round";n.lineWidth=m.strokeWidthValue;n.strokeStyle=m.stroke;n.globalAlpha=m.opacity*m.strokeOpacity;n.stroke()}}},drawLineString:function(l,m){this._drawLines([l],false,m)},drawPolygon:function(l,m){this._drawLines(l,true,m)},drawBbox:function(l,m){this._drawLines([[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]],[l[0],l[1]]]],true,m)},_getGraphicStyle:function(l){function m(s){s=parseInt(s);return+s+""===s?+s:s}l=c.extend({},G.style,l);l.borderRadiusValue=m(l.borderRadius);
l.fill=l.fill||l.color;l.doFill=l.fill&&l.fillOpacity>0;l.stroke=l.stroke||l.color;l.strokeWidthValue=m(l.strokeWidth);l.doStroke=l.stroke&&l.strokeOpacity>0&&l.strokeWidthValue>0;l.widthValue=m(l.width);l.heightValue=m(l.height);return l},_drawLines:function(l,m,s){if(!(!l||!l.length||l[0].length<2)){s=this._getGraphicStyle(s);var A,R;if(s.visibility!="hidden"&&s.opacity>0){n.beginPath();n.moveTo(l[0][0][0],l[0][0][1]);var K=l[0][l[0].length-1];for(A=0;A<l.length;A++){for(R=0;R<l[A].length;R++)n.lineTo(l[A][R][0],
l[A][R][1]);if(m&&A>0){n.lineTo(K[0],K[1]);n.closePath()}}if(m&&s.doFill){n.fillStyle=s.fill;n.globalAlpha=s.opacity*s.fillOpacity;n.fill()}if(s.doStroke){n.lineJoin="round";n.lineWidth=s.strokeWidthValue;n.strokeStyle=s.stroke;n.globalAlpha=s.opacity*s.strokeOpacity;n.stroke()}}}}})})(jQuery);
(function(c,C){var G,e={},g,j,h,n,t,l=[],m,s,A,R,K=null,Z=0,S,T,H,ja,Y,N,na,ba,ca,ia,ga=null,E,O,fa,oa=function(){for(var a=5,b=document.createElement("div"),d=b.all||[];b.innerHTML="<!--[if gt IE "+ ++a+"]><br><![endif]--\>",d[0];);return a>6?a:!a}(),f,k,o,v,y=[],w={},u={},ka={bbox:[-180,-85,180,85],bboxMax:[-180,-85,180,85],center:[0,0],cursors:{pan:"move"},mode:"pan",services:[{id:"OSM",type:"tiled",getUrl:function(a){return"http://tile.openstreetmap.org/"+a.zoom+"/"+a.tile.column+"/"+a.tile.row+
".png"},attr:"&copy; OpenStreetMap &amp; contributors, CC-BY-SA"}],tilingScheme:{tileWidth:256,tileHeight:256,levels:18,basePixelSize:156543.03392799935,origin:[-2.0037508342787E7,2.0037508342787E7]},zoom:0,_serviceTypes:{tiled:function(){var a={};return{create:function(b,d){if(!a[d.id]){a[d.id]={loadCount:0,reloadTiles:false,serviceContainer:null};j.append("<div data-service='"+d.id+"' style='position:absolute; left:0; top:0; width:8px; height:8px; margin:0; padding:0; display:"+(d.visible===C||
d.visible?"block":"none")+";'></div>");a[d.id].serviceContainer=j.children("[data-service='"+d.id+"']")}},destroy:function(b,d){a[d.id].serviceContainer.remove();delete a[d.id]},interactivePan:function(b,d,q,r){if(a[d.id]){this._cancelUnloaded(b,d);a[d.id].serviceContainer.children().css({left:function(ha,pa){return parseInt(pa)+q},top:function(ha,pa){return parseInt(pa)+r}});if(d&&a[d.id]!=null&&(d.visible===C||d.visible)){var p=s,z=a[d.id],D=z.serviceContainer,F=D.children("[data-pixelSize='"+p+
"']"),x=b.options.tilingScheme,B=x.tileWidth,I=x.tileHeight,U=e.width/2*p,L=e.height/2*p,M=F.position(),J=F.data("scaleOrigin").split(","),da=parseInt(J[0])-M.left;M=parseInt(J[1])-M.top;var P=m;J=[P[0]+da*p,P[1]-M*p];var W=Math.floor((J[0]-U-x.origin[0])/(p*B));da=Math.floor((x.origin[1]-(J[1]+L))/(p*I));M=Math.ceil((J[0]+U-x.origin[0])/(p*B));J=Math.ceil((x.origin[1]-(J[1]-L))/(p*I));var X=b._getBboxMax(),V=b._getTiledPixelSize(0),Q=V/p,aa=Math.floor((X[0]-x.origin[0])/(V*B))*Q;X=Math.floor((x.origin[1]-
X[3])/(V*I))*Q;U=Math.round((x.origin[0]+aa*B*p-(P[0]-U))/p);L=Math.round((P[1]+L-(x.origin[1]-X*I*p))/p);var la=d.opacity===C?1:d.opacity;for(P=W;P<M;P++)for(W=da;W<J;W++){V=""+P+","+W;Q=F.children("[data-tile='"+V+"']").removeAttr("data-dirty");if(Q.size()===0){var ma=[x.origin[0]+P*B*p,x.origin[1]-W*I*p],ea=[x.origin[0]+((P+1)*B-1)*p,x.origin[1]-((W+1)*I-1)*p];ma=d.getUrl({bbox:[ma[0],ma[1],ea[0],ea[1]],width:B,height:I,zoom:b._getZoom(),tile:{row:W,column:P},index:Math.abs(W+P)});z.loadCount++;
if(z.reloadTiles&&Q.size()>0)Q.attr("src",ma);else{Q="<img style='position:absolute; left:"+((P-aa)*100+(U-U%B)/B*100)+"%; top:"+((W-X)*100+(L-L%I)/I*100)+"%; ";if(c("body")[0].filters===C)Q+="width: 100%; height: 100%;";Q+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+V+"' />";F.append(Q);Q=F.children(":last");Q.load(function(ha){la<1?c(ha.target).fadeTo(0,la):c(ha.target).show();z.loadCount--;
if(z.loadCount<=0){D.children(":not([data-pixelSize='"+p+"'])").remove();z.loadCount=0}}).error(function(ha){c(ha.target).remove();z.loadCount--;if(z.loadCount<=0){D.children(":not([data-pixelSize='"+p+"'])").remove();z.loadCount=0}}).attr("src",ma)}}}}}},interactiveScale:function(b,d,q,r){if(a[d.id]){this._cancelUnloaded(b,d);var p=b.options.tilingScheme,z=p.tileWidth,D=p.tileHeight;a[d.id].serviceContainer.children().each(function(){var F=c(this),x=F.attr("data-pixelSize")/r;x=Math.round(x*1E3)/
1E3;var B=F.data("scaleOrigin").split(",");B=b._toMap([B[0],B[1]]);B=b._toPixel(B,q,r);F.css({left:Math.round(B[0])+"px",top:Math.round(B[1])+"px",width:z*x,height:D*x});c("body")[0].filters!==C&&F.children().each(function(){c(this).css("filter","progid:DXImageTransform.Microsoft.Matrix(FilterType=bilinear,M11="+x+",M22="+x+",sizingmethod='auto expand')")})})}},refresh:function(b,d){if(d&&a[d.id]&&(d.visible===C||d.visible)){this._cancelUnloaded(b,d);var q=b._getBbox(),r=s,p=a[d.id],z=p.serviceContainer,
D=b.options.tilingScheme,F=D.tileWidth,x=D.tileHeight,B=Math.floor((q[0]-D.origin[0])/(r*F)),I=Math.floor((D.origin[1]-q[3])/(r*x)),U=Math.ceil((q[2]-D.origin[0])/(r*F)),L=Math.ceil((D.origin[1]-q[1])/(r*x)),M=b._getBboxMax(),J=b._getTiledPixelSize(0),da=J/r,P=Math.floor((M[0]-D.origin[0])/(J*F))*da,W=Math.floor((D.origin[1]-M[3])/(J*x))*da,X=Math.round((D.origin[0]+P*F*r-q[0])/r),V=Math.round((q[3]-(D.origin[1]-W*x*r))/r);q=z.children().show();M=q.filter("[data-pixelSize='"+r+"']").appendTo(z);var Q=
d.opacity===C?1:d.opacity;p.reloadTiles&&q.find("img").attr("data-dirty","true");if(M.size()){M.css({left:X%F+"px",top:V%x+"px"}).data("scaleOrigin",X%F+","+V%x);M.children().each(function(){var ea=c(this),ha=ea.attr("data-tile").split(",");ea.css({left:Math.round((parseInt(ha[0])-P)*100+(X-X%F)/F*100)+"%",top:Math.round((parseInt(ha[1])-W)*100+(V-V%x)/x*100)+"%"});Q<1&&ea.fadeTo(0,Q)})}else{z.append("<div style='position:absolute; left:"+X%F+"px; top:"+V%x+"px; width:"+F+"px; height:"+x+"px; margin:0; padding:0;' data-pixelSize='"+
r+"'></div>");M=z.children(":last").data("scaleOrigin",X%F+","+V%x)}for(B=B;B<U;B++)for(J=I;J<L;J++){da=""+B+","+J;var aa=M.children("[data-tile='"+da+"']").removeAttr("data-dirty");if(aa.size()===0||p.reloadTiles){var la=[D.origin[0]+B*F*r,D.origin[1]-J*x*r],ma=[D.origin[0]+((B+1)*F-1)*r,D.origin[1]-((J+1)*x-1)*r];la=d.getUrl({bbox:[la[0],la[1],ma[0],ma[1]],width:F,height:x,zoom:b._getZoom(),tile:{row:J,column:B},index:Math.abs(J+B)});p.loadCount++;if(p.reloadTiles&&aa.size()>0)aa.attr("src",la);
else{aa="<img style='position:absolute; left:"+((B-P)*100+(X-X%F)/F*100)+"%; top:"+((J-W)*100+(V-V%x)/x*100)+"%; ";if(c("body")[0].filters===C)aa+="width: 100%; height: 100%;";aa+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+da+"' />";M.append(aa);aa=M.children(":last");aa.load(function(ea){Q<1?c(ea.target).fadeTo(0,Q):c(ea.target).show();p.loadCount--;if(p.loadCount<=0){z.children(":not([data-pixelSize='"+
r+"'])").remove();p.loadCount=0}}).error(function(ea){c(ea.target).remove();p.loadCount--;if(p.loadCount<=0){z.children(":not([data-pixelSize='"+r+"'])").remove();p.loadCount=0}}).attr("src",la)}}}q.find("[data-dirty]").remove();p.reloadTiles=false}},opacity:function(b,d){a[d.id].serviceContainer.find("img").stop(true).fadeTo("fast",d.opacity)},toggle:function(b,d){a[d.id].serviceContainer.css("display",d.visible?"block":"none")},_cancelUnloaded:function(b,d){var q=a[d.id];if(q&&q.loadCount>0)for(q.serviceContainer.find("img:hidden").remove();q.loadCount>
0;)q.loadCount--}}}(),shingled:function(){var a={};return{create:function(b,d){if(!a[d.id]){a[d.id]={loadCount:0};j.append('<div data-service="'+d.id+'" style="position:absolute; left:0; top:0; width:16px; height:16px; margin:0; padding:0; display:'+(d.visible===C||d.visible?"block":"none")+';"></div>');a[d.id].serviceContainer=j.children('[data-service="'+d.id+'"]')}},destroy:function(b,d){a[d.id].serviceContainer.remove();delete a[d.id]},interactivePan:function(b,d,q,r){if(a[d.id]){this._cancelUnloaded(b,
d);b=a[d.id].serviceContainer.children("[data-pixelSize='"+s+"']");d=b.children("div");if(!d.length){b.children("img").wrap('<div style="position:absolute; left:0; top:0; width:100%; height:100%;"></div>');d=b.children("div")}d.css({left:function(p,z){return parseInt(z)+q},top:function(p,z){return parseInt(z)+r}})}},interactiveScale:function(b,d,q,r){if(a[d.id]){this._cancelUnloaded(b,d);var p=e.width,z=e.height,D=p/2,F=z/2;a[d.id].serviceContainer.children().each(function(){var x=c(this),B=x.attr("data-pixelSize"),
I=B/r;x.css({width:p*I,height:z*I}).children("img").each(function(){var U=c(this),L=U.data("center");U.css({left:(Math.round((L[0]-q[0])/B)-D)*I+"px",top:(Math.round((q[1]-L[1])/B)-F)*I+"px"})})})}},refresh:function(b,d){if(d&&a[d.id]&&(d.visible===C||d.visible)){this._cancelUnloaded(b,d);var q=b._getBbox(),r=s,p=a[d.id],z=p.serviceContainer,D=e.width,F=e.height,x=D/2,B=F/2,I=z.children('[data-pixelSize="'+r+'"]'),U=d.opacity===C?1:d.opacity;if(!I.size()){z.append('<div style="position:absolute; left:'+
x+"px; top:"+B+"px; width:"+D+"px; height:"+F+'px; margin:0; padding:0;" data-pixelSize="'+r+'"></div>');I=z.children(":last")}I.children("img").each(function(){var L=c(this),M=L.data("center");L.css({left:Math.round((M[0]-m[0])/r)-x+"px",top:Math.round((m[1]-M[1])/r)-B+"px"})});U<1&&z.find("img").attr("data-keepAlive","0");q=d.getUrl({bbox:q,width:D,height:F,zoom:b._getZoom(),tile:null,index:0});p.loadCount++;I.append('<img style="position:absolute; left:-'+x+"px; top:-"+B+'px; width:100%; height:100%; margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;" unselectable="on" />');
I.children(":last").data("center",m).load(function(L){U<1?c(L.target).fadeTo(0,U):c(L.target).show();p.loadCount--;if(p.loadCount<=0){z.children(':not([data-pixelSize="'+r+'"])').remove();L=z.find('[data-pixelSize="'+r+'"]>div');if(L.size()>0){var M=L.position();L.children("img").each(function(){var J=c(this),da=M.left+parseInt(J.css("left")),P=M.top+parseInt(J.css("top"));J.css({left:da+"px",top:P+"px"})}).unwrap();L.remove()}p.loadCount=0}}).error(function(L){c(L.target).remove();p.loadCount--;
if(p.loadCount<=0){z.children(":not([data-pixelSize='"+r+"'])").remove();p.loadCount=0}}).attr("src",q)}},opacity:function(b,d){a[d.id].serviceContainer.find("img").stop(true).fadeTo("fast",d.opacity)},_cancelUnloaded:function(b,d){var q=a[d.id];if(q&&q.loadCount>0)for(q.serviceContainer.find("img:hidden").remove();q.loadCount>0;)q.loadCount--}}}()}};c.widget("geo.geomap",function(){return{options:c.extend({},ka),_createWidget:function(a,b){w=a;G=c(b);this._forcePosition(G);G.css("text-align","left");
var d=this._findMapSize();e={x:parseInt(G.css("padding-left")),y:parseInt(G.css("padding-top")),width:d.width,height:d.height};this._createChildren();m=A=[0,0];s=R=156543.03392799935;S=T=H=ja=E=o=v=false;Y=N=ca=ia=O=[0,0];fa=[0.8,0.8];na=ba=0;c.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){u=this.options;k=(f="ontouchend"in document)||oa==7;var a=f?"touchstart":"mousedown",b=f?"touchend touchcancel":"mouseup",d=f?"touchmove":"mousemove";t.dblclick(c.proxy(this._eventTarget_dblclick,
this));t.bind(a,c.proxy(this._eventTarget_touchstart,this));a=t[0].setCapture?t:c(document);a.bind(d,c.proxy(this._dragTarget_touchmove,this));a.bind(b,c.proxy(this._dragTarget_touchstop,this));t.mousewheel(c.proxy(this._eventTarget_mousewheel,this));c(window).resize(function(){ga&&clearTimeout(ga);ga=setTimeout(function(){G.geomap("resize")},500)});h.geographics();if(w){w.bbox&&this._setOption("bbox",w.bbox,false);w.center&&this._setOption("center",w.center,false);w.zoom&&this._setZoom(w.zoom,false,
false)}t.css("cursor",u.cursors[u.mode]);this._createServices();this._refresh()},_setOption:function(a,b,d){d=d===C||d;switch(a){case "bbox":if(c.geo.proj){b=c.geo.proj.fromGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}this._setBbox(b,false,d);b=this._getBbox();if(c.geo.proj){b=c.geo.proj.toGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}break;case "center":this._setCenterAndSize(c.geo.proj?c.geo.proj.fromGeodetic([[b[0],b[1]]])[0]:b,s,false,d);break;
case "zoom":this._setZoom(b,false,d)}c.Widget.prototype._setOption.apply(this,arguments);switch(a){case "services":this._createServices();d&&this._refresh()}},destroy:function(){c.Widget.prototype.destroy.apply(this,arguments);this.element.html("")},getPixelSize:function(){return s},toMap:function(a){a=this._toMap(a);return c.geo.proj?c.geo.proj.toGeodetic(a):a},toPixel:function(a){a=c.geo.proj?c.geo.proj.fromGeodetic(a):a;return this._toPixel(a)},opacity:function(a,b){if(b>=0||b<=1)for(var d=0;d<
u.services.length;d++){var q=u.services[d];if(q.id==a){q.opacity=b;u._serviceTypes[q.type].opacity(this,q);break}}},toggle:function(a,b){for(var d=0;d<u.services.length;d++){var q=u.services[d];if(q.id==a){if(b===C)b=q.visible===C?false:!q.visible;q.visible=b;u._serviceTypes[q.type].toggle(this,q)}}},refresh:function(){this._refresh()},resize:function(){var a=this._findMapSize();e={x:parseInt(G.css("padding-left")),y:parseInt(G.css("padding-top")),width:a.width,height:a.height};g.css({width:a.width,
height:a.height});j.css({width:a.width,height:a.height});t.css({width:a.width,height:a.height});h.geographics("destroy");h.css({width:a.width,height:a.height});h.geographics();this._setCenterAndSize(m,s,false,true)},shapeStyle:function(a){if(a){h.geographics("option","style",a);this._refresh()}else return h.geographics("option","style")},append:function(a,b,d){d=d===C||d;if(a){a=a.type=="FeatureCollection"?a.features:c.isArray(a)?a:[a];c.each(a,function(){y[y.length]={shape:this,style:b}});d&&this._refresh()}},
empty:function(){y=[];this._refresh()},find:function(a,b){this.toPixel(a.coordinates);var d=s*b,q=[],r;c.each(y,function(){if(this.shape.type=="Point")c.geo._distance(this.shape,a)<=d&&q.push(this.shape);else{var p=c.geo._bbox(this.shape);if(c.geo._distance({type:"Polygon",coordinates:[[[p[0],p[1]],[p[0],p[3]],[p[2],p[3]],[p[2],p[1]],[p[0],p[1]]]]},a)<=d){p=c.geo._flatten(this.shape);for(r=0;r<p.length;r++)if(c.geo._distance(p[r],a)<=d){q.push(this.shape);break}}}});return q},remove:function(a){c.each(y,
function(b){if(this.shape==a){var d=y.slice(b+1||y.length);y.length=b<0?y.length+b:b;y.push.apply(y,d);return false}});this._refresh()},_getBbox:function(){var a=e.width/2*s,b=e.height/2*s;return[m[0]-a,m[1]-b,m[0]+a,m[1]+b]},_setBbox:function(a,b,d){var q=[a[0]+(a[2]-a[0])/2,a[1]+(a[3]-a[1])/2];a=Math.max(c.geo._width(a)/e.width,c.geo._height(a)/e.height);if(u.tilingScheme)a=this._getTiledPixelSize(this._getTiledZoom(a));this._setCenterAndSize(q,a,b,d)},_getBboxMax:function(){var a=e.width/2*R,b=
e.height/2*R;return[A[0]-a,A[1]-b,A[0]+a,A[1]+b]},_getZoom:function(){if(u.tilingScheme)return this._getTiledZoom(s);else{var a=e.width/e.height,b=c.geo._reaspect(this._getBbox(),a);a=c.geo._reaspect(this._getBboxMax(),a);return Math.log(c.geo._width(a)/c.geo._width(b))/Math.log(2)}},_setZoom:function(a,b,d){a=Math.max(a,0);if(u.tilingScheme)this._setCenterAndSize(m,this._getTiledPixelSize(a),b,d);else{a=c.geo._scaleBy(this._getBbox(),1/Math.pow(2,a));a=Math.max(c.geo._width(a)/e.width,c.geo._height(a)/
e.height);this._setCenterAndSize(m,a,b,d)}},_createChildren:function(){var a=G.children().detach();this._forcePosition(a);a.css("-moz-user-select","none");G.prepend("<div style='position:absolute; left:"+e.x+"px; top:"+e.y+"px; width:"+e.width+"px; height:"+e.height+"px; margin:0; padding:0; overflow:hidden; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none;' unselectable='on'></div>");t=g=G.children(":first");g.append('<div style="position:absolute; left:0; top:0; width:'+
e.width+"px; height:"+e.height+'px; margin:0; padding:0;"></div>');j=g.children(":last");g.append('<div style="position:absolute; left:0; top:0; width:'+e.width+"px; height:"+e.height+'px; margin:0; padding:0;"></div>');h=g.children(":last");g.append('<div class="ui-widget ui-widget-content ui-corner-all" style="position:absolute; left:0; top:0px; max-width:128px; display:none;"><div style="margin:.2em;"></div></div>');n=g.children(":last");n.children();g.append(a)},_createServices:function(){var a;
for(a=0;a<l.length;a++)u._serviceTypes[l[a].type].destroy(this,l[a]);for(a=0;a<u.services.length;a++)u._serviceTypes[u.services[a].type].create(this,u.services[a],a);l=u.services},_drawGraphics:function(a,b,d){var q,r,p,z,D,F=this;for(q=0;q<b.length;q++){p=b[q].shape||b[q];p=p.geometry||p;z=c.isArray(d)?d[q].style:d;switch(p.type){case "Point":h.geographics("drawPoint",this.toPixel(p.coordinates),z);break;case "LineString":h.geographics("drawLineString",this.toPixel(p.coordinates),z);break;case "Polygon":D=
[];c.each(p.coordinates,function(x){D[x]=F.toPixel(this)});h.geographics("drawPolygon",D,z);break;case "MultiPoint":for(r=0;r<p.coordinates;r++)h.geographics("drawPoint",this.toPixel(p.coordinates[r]),z);break;case "MultiLineString":for(r=0;r<p.coordinates;r++)h.geographics("drawLineString",this.toPixel(p.coordinates[r]),z);break;case "MultiPolygon":for(r=0;r<p.coordinates;r++){D=[];c.each(p.coordinates[r],function(x){D[x]=F.toPixel(this)});h.geographics("drawPolygon",D,z)}break;case "GeometryCollection":F._drawGraphics(a,
p.geometries,z)}}},_findMapSize:function(){for(var a={width:0,height:0},b=G;b.size()&&!(a.width>0&&a.height>0);){a={width:b.width(),height:b.height()};if(a.width<=0||a.height<=0)a={width:parseInt(b.css("width")),height:parseInt(b.css("height"))};b=b.parent()}return a},_forcePosition:function(a){var b=a.css("position");b!="relative"&&b!="absolute"&&b!="fixed"&&a.css("position","relative")},_getTiledPixelSize:function(a){var b=u.tilingScheme;if(b!=null){if(a===0)return b.pixelSizes!=null?b.pixelSizes[0]:
b.basePixelSize;a=Math.round(a);a=Math.max(a,0);a=Math.min(a,(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-1);return b.pixelSizes!=null?b.pixelSizes[a]:b.basePixelSize/Math.pow(2,a)}else return NaN},_getTiledZoom:function(a){var b=u.tilingScheme;if(b.pixelSizes!=null){a=Math.floor(a*1E3);for(var d=(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-1;d>=0;d--)if(Math.floor(b.pixelSizes[d]*1E3)>=a)return d;return 0}else return Math.max(Math.round(Math.log(b.basePixelSize/a)/Math.log(2)),0)},_getZoomCenterAndSize:function(a,
b,d){if(u.tilingScheme){b=this._getTiledZoom(s)+b;b=this._getTiledPixelSize(b)}else{b=Math.pow(d,-b);b=s*b}d=b/s;a=this._toMap(a);d=[(m[0]-a[0])*d,(m[1]-a[1])*d];return{pixelSize:b,center:[a[0]+d[0],a[1]+d[1]]}},_mouseWheelFinish:function(){K=null;if(Z!=0){var a=this._getZoomCenterAndSize(Y,Z,1.18920711500273);Z=0;this._setCenterAndSize(a.center,a.pixelSize,true,true)}else this._refresh()},_panEnd:function(){O=[O[0]>0?Math.floor(O[0]*fa[0]):Math.ceil(O[0]*fa[0]),O[1]>0?Math.floor(O[1]*fa[1]):Math.ceil(O[1]*
fa[1])];if(Math.abs(O[0])<4&&Math.abs(O[1])<4)this._panFinalize();else{N=[N[0]+O[0],N[1]+O[1]];this._panMove();setTimeout(c.proxy(this._panEnd,this),30)}},_panFinalize:function(){if(E){O=[0,0];var a=-(N[0]-Y[0])*s,b=(N[1]-Y[1])*s;h.css({left:0,top:0});this._setCenterAndSize([m[0]+a,m[1]+b],s,true,true);T=false;Y=N;H=E=false;t.css("cursor",u.cursors[u.mode])}},_panMove:function(){var a=N[0]-ia[0],b=N[1]-ia[1];if(H||a>3||a<-3||b>3||b<-3){if(!H){H=true;t.css("cursor",u.cursors.pan)}if(S)O=[a,b];if(a!=
0||b!=0){E=true;ia=N;for(i=0;i<u.services.length;i++){var d=u.services[i];u._serviceTypes[d.type].interactivePan(this,d,a,b)}h.css({left:function(q,r){return parseInt(r)+a},top:function(q,r){return parseInt(r)+b}})}}},_refresh:function(){for(var a=0;a<u.services.length;a++){var b=u.services[a];!S&&u._serviceTypes[b.type]!=null&&u._serviceTypes[b.type].refresh(this,b)}if(h){h.geographics("clear");y.length>0&&this._drawGraphics(h,y,y)}},_setCenterAndSize:function(a,b,d,q){if(s!=b){h.geographics("clear");
for(var r=0;r<u.services.length;r++){var p=u.services[r];u._serviceTypes[p.type].interactiveScale(this,p,a,b)}}m=a;s=b;if(c.geo.proj){a=this._getBbox();a=c.geo.proj.toGeodetic([[a[0],a[1]],[a[2],a[3]]]);a=[a[0][0],a[0][1],a[1][0],a[1][1]];u.bbox=a;u.center=c.geo.proj.toGeodetic([[m[0],m[1]]])[0]}else{u.bbox=this._getBbox();u.center=m}u.zoom=this._getZoom();d&&this._trigger("bboxchange",window.event,{bbox:u.bbox});q&&this._refresh()},_toMap:function(a,b,d){var q=c.isArray(a[0]);q||(a=[a]);b=b||m;d=
d||s;var r=e.width,p=e.height,z=r/2*d;d=p/2*d;var D=[b[0]-z,b[1]-d,b[0]+z,b[1]+d],F=c.geo._width(D)/r,x=c.geo._height(D)/p,B=[];c.each(a,function(I){B[I]=[D[0]+this[0]*F,D[3]-this[1]*x]});return q?B:B[0]},_toPixel:function(a,b,d){var q=c.isArray(a[0]);q||(a=[a]);b=b||m;d=d||s;var r=e.width,p=e.height,z=r/2*d;d=p/2*d;var D=[b[0]-z,b[1]-d,b[0]+z,b[1]+d],F=c.geo._width(D),x=c.geo._height(D),B=[];c.each(a,function(I){B[I]=[Math.round((this[0]-D[0])*r/F),Math.round((D[3]-this[1])*p/x)]});return q?B:B[0]},
_zoomTo:function(a,b,d,q){b=b<0?0:b;var r=this._getTiledPixelSize(b);if(isNaN(r)){b=c.geo._scaleBy(this._getBboxMax(),1/Math.pow(2,b));b=Math.max(c.geo._width(b)/e.width,c.geo._height(b)/e.height);this._setCenterAndSize(a,b,d,q)}else this._setCenterAndSize(a,r,d,q)},_eventTarget_dblclick:function(a){this._panFinalize();c(a.currentTarget).offset();switch(u.mode){case "pan":this._trigger("dblclick",a,{type:"Point",coordinates:this.toMap(N)});if(!a.isDefaultPrevented()){a=this._getZoomCenterAndSize(N,
1,2);this._setCenterAndSize(a.center,a.pixelSize,true,true)}}T=false},_eventTarget_touchstart:function(a){if(!(!f&&a.which!=1)){var b=c(a.currentTarget).offset();N=f?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];if(k){b=c.now();if(b-na<750){if(o){var d=N[0]-Y[0],q=N[1]-Y[1];if(Math.sqrt(d*d+q*q)>10)o=false}v=v?false:o}else v=false;o=true;na=b}a.preventDefault();this._panFinalize();this._mouseWheelFinish();S=true;Y=N;if(!T&&
a.shiftKey){ja=true;t.css("cursor",u.cursors.zoom)}else{T=true;switch(u.mode){case "pan":ia=N;a.currentTarget.setCapture&&a.currentTarget.setCapture()}}return false}},_dragTarget_touchmove:function(a){var b=t.offset();b=f?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];if(!(b[0]==ca[0]&&b[1]==ca[1])){if(k)v=o=false;if(S){N=b;c.now()}switch(ja?"zoom":u.mode){case "pan":S||H?this._panMove():this._trigger("move",a,{type:"Point",
coordinates:this.toMap(b)})}ca=b}},_dragTarget_touchstop:function(a){!S&&oa==7&&this._eventTarget_touchstart(a);var b=S,d=H,q=t.offset();q=f?[a.originalEvent.changedTouches[0].pageX-q.left,a.originalEvent.changedTouches[0].pageY-q.top]:[a.pageX-q.left,a.pageY-q.top];var r=ja?"zoom":u.mode;t.css("cursor",u.cursors[r]);ja=S=H=false;document.releaseCapture&&document.releaseCapture();if(b){b=c.now();N=q;switch(r){case "pan":if(d)this._panEnd();else if(b-ba>100){this._trigger("click",a,{type:"Point",coordinates:this.toMap(q)});
T=false}}ba=b;if(k&&v){v=o=false;t.trigger("dblclick",a)}}},_eventTarget_mousewheel:function(a,b){a.preventDefault();this._panFinalize();if(!S){if(b!=0){if(K){window.clearTimeout(K);K=null}else{var d=c(a.currentTarget).offset();Y=[a.pageX-d.left,a.pageY-d.top]}Z+=b;d=this._getZoomCenterAndSize(Y,Z,1.18920711500273);h.geographics("clear");for(i=0;i<u.services.length;i++){var q=u.services[i];u._serviceTypes[q.type].interactiveScale(this,q,d.center,d.pixelSize)}var r=this;K=window.setTimeout(function(){r._mouseWheelFinish()},
1E3)}return false}}}}())})(jQuery);
