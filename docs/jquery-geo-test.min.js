document.createElement("canvas").getContext||function(){function d(){return this.context_||(this.context_=new y(this))}function o(e,g){var q=ia.call(arguments,2);return function(){return e.apply(g,q.concat(ia.call(arguments)))}}function s(e){e.namespaces.g_vml_||e.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");e.namespaces.g_o_||e.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!e.styleSheets.ex_canvas_){e=e.createStyleSheet();e.owningElement.id=
"ex_canvas_";e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function j(e){var g=e.srcElement;switch(e.propertyName){case "width":g.getContext().clearRect();g.style.width=g.attributes.width.nodeValue+"px";g.firstChild.style.width=g.clientWidth+"px";break;case "height":g.getContext().clearRect();g.style.height=g.attributes.height.nodeValue+"px";g.firstChild.style.height=g.clientHeight+"px"}}function c(e){e=e.srcElement;if(e.firstChild){e.firstChild.style.width=
e.clientWidth+"px";e.firstChild.style.height=e.clientHeight+"px"}}function l(){return[[1,0,0],[0,1,0],[0,0,1]]}function n(e,g){for(var q=l(),x=0;x<3;x++)for(var C=0;C<3;C++){for(var p=0,X=0;X<3;X++)p+=e[x][X]*g[X][C];q[x][C]=p}return q}function m(e,g){g.fillStyle=e.fillStyle;g.lineCap=e.lineCap;g.lineJoin=e.lineJoin;g.lineWidth=e.lineWidth;g.miterLimit=e.miterLimit;g.shadowBlur=e.shadowBlur;g.shadowColor=e.shadowColor;g.shadowOffsetX=e.shadowOffsetX;g.shadowOffsetY=e.shadowOffsetY;g.strokeStyle=e.strokeStyle;
g.globalAlpha=e.globalAlpha;g.font=e.font;g.textAlign=e.textAlign;g.textBaseline=e.textBaseline;g.arcScaleX_=e.arcScaleX_;g.arcScaleY_=e.arcScaleY_;g.lineScale_=e.lineScale_}function u(e){var g=e.indexOf("(",3),q=e.indexOf(")",g+1);g=e.substring(g+1,q).split(",");if(g.length!=4||e.charAt(3)!="a")g[3]=1;return g}function h(e,g,q){return Math.min(q,Math.max(g,e))}function r(e,g,q){q<0&&q++;q>1&&q--;return 6*q<1?e+(g-e)*6*q:2*q<1?g:3*q<2?e+(g-e)*(2/3-q)*6:e}function k(e){if(e in ma)return ma[e];var g,
q=1;e=String(e);if(e.charAt(0)=="#")g=e;else if(/^rgb/.test(e)){q=u(e);g="#";for(var x,C=0;C<3;C++){x=q[C].indexOf("%")!=-1?Math.floor(parseFloat(q[C])/100*255):+q[C];g+=da[h(x,0,255)]}q=+q[3]}else if(/^hsl/.test(e)){C=q=u(e);g=parseFloat(C[0])/360%360;g<0&&g++;x=h(parseFloat(C[1])/100,0,1);C=h(parseFloat(C[2])/100,0,1);if(x==0)x=C=g=C;else{var p=C<0.5?C*(1+x):C+x-C*x,X=2*C-p;x=r(X,p,g+1/3);C=r(X,p,g);g=r(X,p,g-1/3)}g="#"+da[Math.floor(x*255)]+da[Math.floor(C*255)]+da[Math.floor(g*255)];q=q[3]}else g=
e;return ma[e]={color:g,alpha:q}}function y(e){this.m_=l();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=Z*1;this.globalAlpha=1;this.canvas=e;var g="width:"+e.clientWidth+"px;height:"+e.clientHeight+"px;overflow:hidden;position:absolute",q=e.ownerDocument.createElement("div");q.style.cssText=g;e.appendChild(q);g=q.cloneNode(false);g.style.backgroundColor="red";g.style.filter="alpha(opacity=0)";
e.appendChild(g);this.element_=q;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function K(e,g,q,x){e.currentPath_.push({type:"bezierCurveTo",cp1x:g.x,cp1y:g.y,cp2x:q.x,cp2y:q.y,x:x.x,y:x.y});e.currentX_=x.x;e.currentY_=x.y}function H(e,g,q){e=e.m_;return{x:Z*(g*e[0][0]+q*e[1][0]+e[2][0])-aa,y:Z*(g*e[0][1]+q*e[1][1]+e[2][1])-aa}}function G(e,g,q){if(isFinite(g[0][0])&&isFinite(g[0][1])&&isFinite(g[1][0])&&isFinite(g[1][1])&&isFinite(g[2][0])&&isFinite(g[2][1])){e.m_=g;if(q)e.lineScale_=na(Q(g[0][0]*
g[1][1]-g[0][1]*g[1][0]))}}function I(e){this.code=this[e];this.message=e+": DOM Exception "+this.code}var P=Math,J=P.round,ja=P.sin,ea=P.cos,Q=P.abs,na=P.sqrt,Z=10,aa=Z/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var ia=Array.prototype.slice;s(document);P={init:function(e){e=e||document;e.createElement("canvas");e.attachEvent("onreadystatechange",o(this.init_,this,e))},init_:function(e){e=e.getElementsByTagName("canvas");for(var g=0;g<e.length;g++)this.initElement(e[g])},initElement:function(e){if(!e.getContext){e.getContext=
d;s(e.ownerDocument);e.innerHTML="";e.attachEvent("onpropertychange",j);e.attachEvent("onresize",c);var g=e.attributes;if(g.width&&g.width.specified)e.style.width=g.width.nodeValue+"px";else e.width=e.clientWidth;if(g.height&&g.height.specified)e.style.height=g.height.nodeValue+"px";else e.height=e.clientHeight}return e}};P.init();for(var da=[],A=0;A<16;A++)for(var fa=0;fa<16;fa++)da[A*16+fa]=A.toString(16)+fa.toString(16);var ma={},ga={butt:"flat",round:"round"};A=y.prototype;A.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);
this.textMeasureEl_=null}this.element_.innerHTML=""};A.beginPath=function(){this.currentPath_=[]};A.moveTo=function(e,g){var q=H(this,e,g);this.currentPath_.push({type:"moveTo",x:q.x,y:q.y});this.currentX_=q.x;this.currentY_=q.y};A.lineTo=function(e,g){var q=H(this,e,g);this.currentPath_.push({type:"lineTo",x:q.x,y:q.y});this.currentX_=q.x;this.currentY_=q.y};A.bezierCurveTo=function(e,g,q,x,C,p){C=H(this,C,p);e=H(this,e,g);q=H(this,q,x);K(this,e,q,C)};A.quadraticCurveTo=function(e,g,q,x){e=H(this,
e,g);q=H(this,q,x);x={x:this.currentX_+2/3*(e.x-this.currentX_),y:this.currentY_+2/3*(e.y-this.currentY_)};K(this,x,{x:x.x+(q.x-this.currentX_)/3,y:x.y+(q.y-this.currentY_)/3},q)};A.arc=function(e,g,q,x,C,p){q*=Z;var X=p?"at":"wa",a=e+ea(x)*q-aa,b=g+ja(x)*q-aa;x=e+ea(C)*q-aa;C=g+ja(C)*q-aa;if(a==x&&!p)a+=0.125;e=H(this,e,g);a=H(this,a,b);x=H(this,x,C);this.currentPath_.push({type:X,x:e.x,y:e.y,radius:q,xStart:a.x,yStart:a.y,xEnd:x.x,yEnd:x.y})};A.stroke=function(e){var g=[];g.push("<g_vml_:shape",
' filled="',!!e,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',Z*10,",",Z*10,'"',' stroked="',!e,'"',' path="');for(var q={x:null,y:null},x={x:null,y:null},C=0;C<this.currentPath_.length;C++){var p=this.currentPath_[C];switch(p.type){case "moveTo":g.push(" m ",J(p.x),",",J(p.y));break;case "lineTo":g.push(" l ",J(p.x),",",J(p.y));break;case "close":g.push(" x ");p=null;break;case "bezierCurveTo":g.push(" c ",J(p.cp1x),",",J(p.cp1y),",",J(p.cp2x),
",",J(p.cp2y),",",J(p.x),",",J(p.y));break;case "at":case "wa":g.push(" ",p.type," ",J(p.x-this.arcScaleX_*p.radius),",",J(p.y-this.arcScaleY_*p.radius)," ",J(p.x+this.arcScaleX_*p.radius),",",J(p.y+this.arcScaleY_*p.radius)," ",J(p.xStart),",",J(p.yStart)," ",J(p.xEnd),",",J(p.yEnd))}if(p){if(q.x==null||p.x<q.x)q.x=p.x;if(x.x==null||p.x>x.x)x.x=p.x;if(q.y==null||p.y<q.y)q.y=p.y;if(x.y==null||p.y>x.y)x.y=p.y}}g.push(' ">');if(e){e=k(this.fillStyle);g.push('<g_vml_:fill color="',e.color,'" opacity="',
e.alpha*this.globalAlpha,'" />')}else{q=k(this.strokeStyle);e=q.color;q=q.alpha*this.globalAlpha;x=this.lineScale_*this.lineWidth;if(x<1)q*=x;g.push("<g_vml_:stroke",' opacity="',q,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',ga[this.lineCap]||"square",'"',' weight="',x,'px"',' color="',e,'" />')}g.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",g.join(""))};A.fill=function(){this.stroke(true)};A.closePath=function(){this.currentPath_.push({type:"close"})};
A.save=function(){var e={};m(this,e);this.aStack_.push(e);this.mStack_.push(this.m_);this.m_=n(l(),this.m_)};A.restore=function(){if(this.aStack_.length){m(this.aStack_.pop(),this);this.m_=this.mStack_.pop()}};A.translate=function(e,g){G(this,n([[1,0,0],[0,1,0],[e,g,1]],this.m_),false)};A.scale=function(e,g){this.arcScaleX_*=e;this.arcScaleY_*=g;G(this,n([[e,0,0],[0,g,0],[0,0,1]],this.m_),true)};A=I.prototype=Error();A.INDEX_SIZE_ERR=1;A.DOMSTRING_SIZE_ERR=2;A.HIERARCHY_REQUEST_ERR=3;A.WRONG_DOCUMENT_ERR=
4;A.INVALID_CHARACTER_ERR=5;A.NO_DATA_ALLOWED_ERR=6;A.NO_MODIFICATION_ALLOWED_ERR=7;A.NOT_FOUND_ERR=8;A.NOT_SUPPORTED_ERR=9;A.INUSE_ATTRIBUTE_ERR=10;A.INVALID_STATE_ERR=11;A.SYNTAX_ERR=12;A.INVALID_MODIFICATION_ERR=13;A.NAMESPACE_ERR=14;A.INVALID_ACCESS_ERR=15;A.VALIDATION_ERR=16;A.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=P;CanvasRenderingContext2D=y;DOMException=I}();
(function(d){function o(j){var c=[].slice.call(arguments,1),l=0;j=d.event.fix(j||window.event);j.type="mousewheel";if(j.wheelDelta)l=j.wheelDelta/120;if(j.detail)l=-j.detail/3;c.unshift(j,l);return d.event.handle.apply(this,c)}var s=["DOMMouseScroll","mousewheel"];d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var j=s.length;j;)this.addEventListener(s[--j],o,false);else this.onmousewheel=o},teardown:function(){if(this.removeEventListener)for(var j=s.length;j;)this.removeEventListener(s[--j],
o,false);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(j){return j?this.bind("mousewheel",j):this.trigger("mousewheel")},unmousewheel:function(j){return this.unbind("mousewheel",j)}})})(jQuery);
$.widget||function(d,o){var s=Array.prototype.slice,j=d.cleanData;d.cleanData=function(c){for(var l=0,n;(n=c[l])!=null;l++)d(n).triggerHandler("remove");j(c)};d.widget=function(c,l,n){var m=c.split(".")[0],u;c=c.split(".")[1];u=m+"-"+c;if(!n){n=l;l=d.Widget}d.expr[":"][u]=function(r){return!!d.data(r,c)};d[m]=d[m]||{};d[m][c]=d.extend(function(r,k){if(!this._createWidget)return new d[m][c](r,k);arguments.length&&this._createWidget(r,k)},d[m][c]);var h=new l;h.options=d.extend(true,{},h.options);d.each(n,
function(r,k){if(d.isFunction(k))n[r]=function(){var y=function(H){return l.prototype[H].apply(this,s.call(arguments,1))},K=function(H,G){return l.prototype[H].apply(this,G)};return function(){var H=this._super,G=this._superApply,I;this._super=y;this._superApply=K;I=k.apply(this,arguments);this._super=H;this._superApply=G;return I}}()});d[m][c].prototype=d.extend(true,h,{namespace:m,widgetName:c,widgetEventPrefix:c,widgetBaseClass:u},n);d.widget.bridge(c,d[m][c])};d.widget.bridge=function(c,l){d.fn[c]=
function(n){var m=typeof n==="string",u=s.call(arguments,1),h=this;n=!m&&u.length?d.extend.apply(null,[true,n].concat(u)):n;m?this.each(function(){var r=d.data(this,c);if(!r)return d.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+n+"'");if(!d.isFunction(r[n])||n.charAt(0)==="_")return d.error("no such method '"+n+"' for "+c+" widget instance");var k=r[n].apply(r,u);if(k!==r&&k!==o){h=k;return false}}):this.each(function(){var r=d.data(this,c);r?r.option(n||
{})._init():l(n,this)});return h}};d.Widget=function(c,l){if(!this._createWidget)return new d[namespace][name](c,l);arguments.length&&this._createWidget(c,l)};d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false},_createWidget:function(c,l){l=d(l||this.defaultElement||this)[0];this.element=d(l);this.options=d.extend(true,{},this.options,this._getCreateOptions(),c);this.bindings=d();this.hoverable=d();this.focusable=d();if(l!==this){d.data(l,this.widgetName,
this);this._bind({remove:"destroy"})}this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return d.metadata&&d.metadata.get(this.element[0])[this.widgetName]},_create:d.noop,_init:d.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},option:function(c,l){var n=c;if(arguments.length===0)return d.extend({},this.options);if(typeof c==="string"){if(l===o)return this.options[c];n={};n[c]=l}this._setOptions(n);return this},_setOptions:function(c){var l=this;d.each(c,function(n,m){l._setOption(n,m)});return this},_setOption:function(c,l){this.options[c]=l;if(c==="disabled"){this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",
!!l).attr("aria-disabled",l);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_bind:function(c,l){if(l){c=d(c);this.bindings=this.bindings.add(c)}else{l=c;c=this.element}var n=this;d.each(l,function(m,u){c.bind(m+"."+n.widgetName,function(){if(!(n.options.disabled===true||d(this).hasClass("ui-state-disabled")))return(typeof u===
"string"?n[u]:u).apply(n,arguments)})})},_hoverable:function(c){this.hoverable=this.hoverable.add(c);this._bind(c,{mouseenter:function(l){d(l.currentTarget).addClass("ui-state-hover")},mouseleave:function(l){d(l.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(c){this.focusable=this.focusable.add(c);this._bind(c,{focusin:function(l){d(l.currentTarget).addClass("ui-state-focus")},focusout:function(l){d(l.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(c,l,n){var m=
this.options[c];l=d.Event(l);l.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase();n=n||{};if(l.originalEvent){c=d.event.props.length;for(var u;c;){u=d.event.props[--c];l[u]=l.originalEvent[u]}}this.element.trigger(l,n);n=d.isArray(n)?[l].concat(n):[l,n];return!(d.isFunction(m)&&m.apply(this.element[0],n)===false||l.isDefaultPrevented())}}}(jQuery);
(function(d){d.geo={_center:function(o){return[(o[0]+o[2])/2,(o[1]+o[3])/2]},_expandBy:function(o,s,j){o=this._center(o);return[o[0]-s,o[1]-j,o[0]+s,o[1]+j]},_height:function(o){return o[3]-o[1]},_reaspect:function(o,s){var j=this._width(o),c=this._height(o),l=this._center(o);if(j==0||c==0||s<=0)return o;if(j/c>s){j=j/2;c=j/s}else{c=c/2;j=c*s}return[l[0]-j,l[1]-c,l[0]+j,l[1]+c]},_scaleBy:function(o,s){return this._expandBy(o,this._width(o)*s/2,this._height(o)*s/2)},_width:function(o){return o[2]-
o[0]},_contains:function(o,s){if(o.type!="Polygon")return false;switch(s.type){case "Point":return this._containsPolygonPoint(o.coordinates,s.coordinates);case "LineString":return this._containsPolygonLineString(o.coordinates,s.coordinates);case "Polygon":return this._containsPolygonLineString(o.coordinates,s.coordinates[0])}},_containsPolygonPoint:function(o,s){if(o.length==0||o[0].length<4)return false;for(var j=0,c=o[0][0],l=1,n;l<o[0].length;l++){n=o[0][l];if(c[1]<=s[1]&&s[1]<n[1]||n[1]<=s[1]&&
s[1]<c[1]&&(s[0]<c[0]||s[0]<n[0])){c=c[0]+(n[0]-c[0])*(s[1]-c[1])/(n[1]-c[1]);c>s[0]&&j++}c=n}return j%2==1},_containsPolygonLineString:function(o,s){for(var j=0;j<s.length;j++)if(!this._containsPolygonPoint(o,s[j]))return false;return true},_distance:function(o,s){var j=d.isArray(o)?o:o.coordinates,c=d.isArray(s)?s:s.coordinates;j=d.geo.proj?d.geo.proj.fromGeodetic(j):j;c=d.geo.proj?d.geo.proj.fromGeodetic(c):c;switch(o.type){case "Point":switch(s.type){case "Point":return this._distancePointPoint(c,
j);case "LineString":return this._distanceLineStringPoint(c,j);case "Polygon":return this._containsPolygonPoint(c,j)?0:this._distanceLineStringPoint(c[0],j);default:throw Error("not implemented");}case "LineString":switch(s.type){case "Point":return this._distanceLineStringPoint(j,c);case "LineString":return this._distanceLineStringLineString(j,c);case "Polygon":return this._containsPolygonLineString(c,j)?0:this._distanceLineStringLineString(c[0],j);default:throw Error("not implemented");}case "Polygon":switch(s.type){case "Point":return this._containsPolygonPoint(j,
c)?0:this._distanceLineStringPoint(j[0],c);case "LineString":return this._containsPolygonLineString(j,c)?0:this._distanceLineStringLineString(j[0],c);case "Polygon":return this._containsPolygonLineString(j,c[0])?0:this._distanceLineStringLineString(j[0],c[0]);default:throw Error("not implemented");}}},_distancePointPoint:function(o,s){var j=s[0]-o[0],c=s[1]-o[1];return Math.sqrt(j*j+c*c)},_distanceLineStringPoint:function(o,s){var j=Number.POSITIVE_INFINITY;if(o.length>0){var c=o[0],l=s[0]-c[0],n=
s[1]-c[1];if(o.length==1)return Math.sqrt(l*l+n*n);else for(var m=1;m<o.length;m++){var u=o[m],h=s[0]-u[0],r=s[1]-u[1];c=this._distanceSegmentPoint(u[0]-c[0],u[1]-c[1],l,n,h,r);if(c==0)return 0;if(c<j)j=c;c=u;l=h;n=r}}return Math.sqrt(j)},_distanceSegmentPoint:function(o,s,j,c,l,n){var m=o*j+s*c;if(m<=0)return j*j+c*c;o=o*o+s*s;if(m>=o)return l*l+n*n;return j*j+c*c-m*m/o},_distanceLineStringLineString:function(o,s){for(var j=Number.POSITIVE_INFINITY,c=0;c<s;c++)j=Math.min(j,this._distanceLineStringPoint(o,
s[c]));return j},proj:function(){function o(c){return c>Math.PI?c-=s:c<-Math.PI?c+=s:c}var s=6.283185307179586;this.CoordinateSystem=function(c,l,n,m){if(arguments.length<2)l=0;if(arguments.length<3)n=0;if(arguments.length<4)m=1;switch(m){case "meters":m=1;break;case "feet":m=3.2808333333333333}this.toGeodetic=function(u){return c.toGeodetic({x:(u.x-l)/m,y:(u.y-n)/m})};this.toProjected=function(u){u=c.toProjected(u);return{x:u.x*m+l,y:u.y*m+n}}};this.Mercator=function(c,l,n){c*=0.017453292519943295;
l*=0.017453292519943295;var m=n.e*n.e,u=Math.sin(l),h=1/(Math.sqrt(1-m*u*u)/Math.cos(l));l=m*m;u=l*m;var r=u*m,k=m/2+5*l/24+u/12+13*r/360,y=7*l/48+29*u/240+811*r/11520,K=7*u/120+81*r/1120,H=4279*r/161280;this.toGeodetic=function(G){var I=o(c+G.x/(h*n.smaj));G=1.5707963267948966-2*Math.atan(1/Math.exp(G.y/(h*n.smaj)));return{x:I*57.29577951308232,y:(G+k*Math.sin(2*G)+y*Math.sin(4*G)+K*Math.sin(6*G)+H*Math.sin(8*G))*57.29577951308232}};this.toProjected=function(G){var I=G.y*0.017453292519943295,P=n.e*
Math.sin(I);I=Math.tan(Math.PI/4+I/2)*Math.pow((1-P)/(1+P),n.e/2);G=o(G.x*0.017453292519943295-c);return{x:h*n.smaj*G,y:h*n.smaj*Math.log(I)}}};this.Spheroid=function(c,l){switch(typeof c){case "number":this.smaj=c;this.e=l;break;case "string":switch(c){case "WGS84Sphere":this.smaj=6378137;this.e=0}}this.smin=this.smaj*Math.sqrt(1-this.e*this.e);var n=(this.smaj-this.smin)/this.smaj;this.distance=function(m,u,h){if(arguments.length<3)h=1;switch(h){case "meters":h=1;break;case "feet":h=3.2808333333333333}var r=
m.y*0.017453292519943295,k=u.y*0.017453292519943295,y=(r+k)*0.5,K=(r-k)*0.5,H=(m.x*0.017453292519943295-u.x*0.017453292519943295)*0.5;r=Math.sin(y);r*=r;y=Math.cos(y);y*=y;k=Math.sin(K);k*=k;K=Math.cos(K);K*=K;var G=Math.sin(H);G*=G;var I=Math.cos(H);I*=I;H=k*I+y*G;G=K*I+r*G;I=Math.atan(Math.sqrt(H/G));var P=Math.sqrt(H*G)/I;return 2*this.smaj*I*(1+n*((3*P-1)/(2*G)*r*K-(3*P+1)/(2*H)*y*k))*h}};var j=new Mercator(0,0,new Spheroid("WGS84Sphere"));return{fromGeodeticPos:function(c){c=j.toProjected({x:c[0],
y:c[1]});return[c.x,c.y]},fromGeodetic:function(c){var l=d.isArray(c[0]),n=l&&d.isArray(c[0][0]),m=n&&d.isArray(c[0][0][0]),u=[[[]]],h=this.fromGeodeticPos;if(!m){if(!n){l||(c=[c]);c=[c]}c=[c]}d.each(c,function(r){d.each(this,function(k){d.each(this,function(y){u[r][k][y]=h(this)})})});return m?u:n?u[0]:l?u[0][0]:u[0][0][0]},toGeodeticPos:function(c){c=j.toGeodetic({x:c[0],y:c[1]});return[c.x,c.y]},toGeodetic:function(c){var l=d.isArray(c[0]),n=l&&d.isArray(c[0][0]),m=n&&d.isArray(c[0][0][0]),u=[[[]]],
h=this.toGeodeticPos;if(!m){if(!n){l||(c=[c]);c=[c]}c=[c]}d.each(c,function(r){d.each(this,function(k){d.each(this,function(y){u[r][k][y]=h(this)})})});return m?u:n?u[0]:l?u[0][0]:u[0][0][0]}}}()}})(jQuery,this);
(function(d){var o,s,j=true,c,l,n,m,u=function(){for(var h=5,r=document.createElement("div"),k=r.all||[];r.innerHTML="<!--[if gt IE "+ ++h+"]><br><![endif]--\>",k[0];);return h>6?h:!h}();d.widget("geo.geographics",{options:{style:{borderRadius:"8px",color:"#7f0000",fillOpacity:0.2,height:"8px",opacity:1,strokeOpacity:1,strokeWidth:"2px",visibility:"visible",width:"8px"}},_create:function(){o=this.element;s=this.options;o.css({display:"inline-block",overflow:"hidden",textAlign:"left"});o.css("position")==
"static"&&o.css("position","relative");c=o.width();l=o.height();if(!(c&&l)){c=parseInt(o.css("width"));l=parseInt(o.css("height"))}if(document.createElement("canvas").getContext){o.append('<canvas width="'+c+'" height="'+l+'" style="position:absolute; left:0; top:0; width:'+c+"px; height:"+l+'px;"></canvas>');n=o.children(":last");m=n[0].getContext("2d")}else if(u<=8){j=false;o.append('<div width="'+c+'" height="'+l+'" style="position:absolute; left:0; top:0; width:'+c+"px; height:"+l+'px; margin:0; padding:0;"></div>');
n=o.children(":last");G_vmlCanvasManager.initElement(n[0]);m=n[0].getContext("2d");n.children().css({backgroundColor:"transparent",width:c,height:l})}},_setOption:function(h,r){if(h=="style")r=d.extend({},s.style,r);d.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){d.Widget.prototype.destroy.apply(this,arguments);o.html("")},clear:function(){m.clearRect(0,0,c,l)},drawArc:function(h,r,k,y){y=this._getGraphicStyle(y);if(y.visibility!="hidden"&&y.widthValue>0&&y.heightValue>0){var K=
Math.min(y.widthValue,y.heightValue)/2;r=r*Math.PI/180;k=k*Math.PI/180;m.save();m.translate(h[0],h[1]);y.widthValue>y.heightValue?m.scale(y.widthValue/y.heightValue,1):m.scale(1,y.heightValue/y.widthValue);m.beginPath();m.arc(0,0,K,r,k,false);j&&m.restore();if(y.doFill){m.fillStyle=y.fill;m.globalAlpha=y.opacity*y.fillOpacity;m.fill()}if(y.doStroke){m.lineJoin="round";m.lineWidth=y.strokeWidthValue;m.strokeStyle=y.stroke;m.globalAlpha=y.opacity*y.strokeOpacity;m.stroke()}j||m.restore()}},drawPoint:function(h,
r){var k=this._getGraphicStyle(r);if(k.widthValue==k.heightValue&&k.heightValue==k.borderRadiusValue)this.drawArc(h,0,360,r);else if(k.visibility!="hidden"){k.borderRadiusValue=Math.min(Math.min(k.widthValue,k.heightValue)/2,k.borderRadiusValue);h[0]-=k.widthValue/2;h[1]-=k.heightValue/2;m.beginPath();m.moveTo(h[0]+k.borderRadiusValue,h[1]);m.lineTo(h[0]+k.widthValue-k.borderRadiusValue,h[1]);m.quadraticCurveTo(h[0]+k.widthValue,h[1],h[0]+k.widthValue,h[1]+k.borderRadiusValue);m.lineTo(h[0]+k.widthValue,
h[1]+k.heightValue-k.borderRadiusValue);m.quadraticCurveTo(h[0]+k.widthValue,h[1]+k.heightValue,h[0]+k.widthValue-k.borderRadiusValue,h[1]+k.heightValue);m.lineTo(h[0]+k.borderRadiusValue,h[1]+k.heightValue);m.quadraticCurveTo(h[0],h[1]+k.heightValue,h[0],h[1]+k.heightValue-k.borderRadiusValue);m.lineTo(h[0],h[1]+k.borderRadiusValue);m.quadraticCurveTo(h[0],h[1],h[0]+k.borderRadiusValue,h[1]);m.closePath();if(k.doFill){m.fillStyle=k.fill;m.globalAlpha=k.opacity*k.fillOpacity;m.fill()}if(k.doStroke){m.lineJoin=
"round";m.lineWidth=k.strokeWidthValue;m.strokeStyle=k.stroke;m.globalAlpha=k.opacity*k.strokeOpacity;m.stroke()}}},drawLineString:function(h,r){this._drawLines([h],false,r)},drawPolygon:function(h,r){this._drawLines(h,true,r)},drawBbox:function(h,r){this._drawLines([[[h[0],h[1]],[h[0],h[3]],[h[2],h[3]],[h[2],h[1]],[h[0],h[1]]]],true,r)},_getGraphicStyle:function(h){function r(k){k=parseInt(k);return+k+""===k?+k:k}h=d.extend({},s.style,h);h.borderRadiusValue=r(h.borderRadius);h.fill=h.fill||h.color;
h.fillOpacity=h.fillOpacity||h.opacity;h.doFill=h.fill&&h.fillOpacity>0;h.stroke=h.stroke||h.color;h.strokeOpacity=h.strokeOpacity||h.opacity;h.strokeWidthValue=r(h.strokeWidth);h.doStroke=h.stroke&&h.strokeOpacity>0&&h.strokeWidthValue>0;h.widthValue=r(h.width);h.heightValue=r(h.height);return h},_drawLines:function(h,r,k){if(!(!h||!h.length||h[0].length<2)){k=this._getGraphicStyle(k);var y,K;if(k.visibility!="hidden"){m.beginPath();m.moveTo(h[0][0][0],h[0][0][1]);var H=h[0][h[0].length-1];for(y=
0;y<h.length;y++){for(K=0;K<h[y].length;K++)m.lineTo(h[y][K][0],h[y][K][1]);if(r&&y>0){m.lineTo(H[0],H[1]);m.closePath()}}if(r&&k.doFill){m.fillStyle=k.fill;m.globalAlpha=k.opacity*k.fillOpacity;m.fill()}if(k.doStroke){m.lineJoin="round";m.lineWidth=k.strokeWidthValue;m.strokeStyle=k.stroke;m.globalAlpha=k.opacity*k.strokeOpacity;m.stroke()}}}}})})(jQuery);
(function(d,o){var s,j={},c,l,n,m,u,h=[],r,k,y,K,H=null,G=0,I,P,J,ja,ea,Q,na,Z,aa,ia,da,A,fa,ma=function(){for(var a=5,b=document.createElement("div"),f=b.all||[];b.innerHTML="<!--[if gt IE "+ ++a+"]><br><![endif]--\>",f[0];);return a>6?a:!a}(),ga,e,g,q,x=[],C={},p={},X={bbox:[-180,-85,180,85],bboxMax:[-180,-85,180,85],center:[0,0],cursors:{pan:"move"},mode:"pan",services:[{id:"OSM",type:"tiled",getUrl:function(a){return"http://tile.openstreetmap.org/"+a.zoom+"/"+a.tile.column+"/"+a.tile.row+".png"},
attr:"&copy; OpenStreetMap &amp; contributors, CC-BY-SA"}],tilingScheme:{tileWidth:256,tileHeight:256,levels:18,basePixelSize:156543.03392799935,origin:[-2.0037508342787E7,2.0037508342787E7]},zoom:0,_serviceTypes:{tiled:function(){var a={};return{create:function(b,f){if(!a[f.id]){a[f.id]={loadCount:0,reloadTiles:false,serviceContainer:null};l.append("<div data-service='"+f.id+"' style='position:absolute; left:0; top:0; width:8px; height:8px; margin:0; padding:0; display:"+(f.visible===o||f.visible?
"block":"none")+";'></div>");a[f.id].serviceContainer=l.children("[data-service='"+f.id+"']")}},destroy:function(b,f){a[f.id].serviceContainer.remove();delete a[f.id]},interactivePan:function(b,f,v,w){if(a[f.id]){this._cancelUnloaded(b,f);a[f.id].serviceContainer.children().css({left:function(ha,oa){return parseInt(oa)+v},top:function(ha,oa){return parseInt(oa)+w}});if(f&&a[f.id]!=null&&(f.visible===o||f.visible)){var t=k,B=a[f.id],E=B.serviceContainer,F=E.children("[data-pixelSize='"+t+"']"),z=b.options.tilingScheme,
D=z.tileWidth,L=z.tileHeight,T=j.width/2*t,N=j.height/2*t,O=F.position(),M=F.data("scaleOrigin").split(","),ba=parseInt(M[0])-O.left;O=parseInt(M[1])-O.top;var R=r;M=[R[0]+ba*t,R[1]-O*t];var V=Math.floor((M[0]-T-z.origin[0])/(t*D));ba=Math.floor((z.origin[1]-(M[1]+N))/(t*L));O=Math.ceil((M[0]+T-z.origin[0])/(t*D));M=Math.ceil((z.origin[1]-(M[1]-N))/(t*L));var W=b._getBboxMax(),U=b._getTiledPixelSize(0),S=U/t,Y=Math.floor((W[0]-z.origin[0])/(U*D))*S;W=Math.floor((z.origin[1]-W[3])/(U*L))*S;T=Math.round((z.origin[0]+
Y*D*t-(R[0]-T))/t);N=Math.round((R[1]+N-(z.origin[1]-W*L*t))/t);var ka=f.opacity===o?1:f.opacity;for(R=V;R<O;R++)for(V=ba;V<M;V++){U=""+R+","+V;S=F.children("[data-tile='"+U+"']").removeAttr("data-dirty");if(S.size()===0){var la=[z.origin[0]+R*D*t,z.origin[1]-V*L*t],ca=[z.origin[0]+((R+1)*D-1)*t,z.origin[1]-((V+1)*L-1)*t];la=f.getUrl({bbox:[la[0],la[1],ca[0],ca[1]],width:D,height:L,zoom:b._getZoom(),tile:{row:V,column:R},index:Math.abs(V+R)});B.loadCount++;if(B.reloadTiles&&S.size()>0)S.attr("src",
la);else{S="<img style='position:absolute; left:"+((R-Y)*100+(T-T%D)/D*100)+"%; top:"+((V-W)*100+(N-N%L)/L*100)+"%; ";if(d("body")[0].filters===o)S+="width: 100%; height: 100%;";S+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+U+"' />";F.append(S);S=F.children(":last");S.load(function(ha){ka<1?d(ha.target).fadeTo(0,ka):d(ha.target).show();B.loadCount--;if(B.loadCount<=0){E.children(":not([data-pixelSize='"+
t+"'])").remove();B.loadCount=0}}).error(function(ha){d(ha.target).remove();B.loadCount--;if(B.loadCount<=0){E.children(":not([data-pixelSize='"+t+"'])").remove();B.loadCount=0}}).attr("src",la)}}}}}},interactiveScale:function(b,f,v,w){if(a[f.id]){this._cancelUnloaded(b,f);var t=b.options.tilingScheme,B=t.tileWidth,E=t.tileHeight;a[f.id].serviceContainer.children().each(function(){var F=d(this),z=F.attr("data-pixelSize")/w;z=Math.round(z*1E3)/1E3;var D=F.data("scaleOrigin").split(",");D=b._toMap([D[0],
D[1]]);D=b._toPixel(D,v,w);F.css({left:Math.round(D[0])+"px",top:Math.round(D[1])+"px",width:B*z,height:E*z});d("body")[0].filters!==o&&F.children().each(function(){d(this).css("filter","progid:DXImageTransform.Microsoft.Matrix(FilterType=bilinear,M11="+z+",M22="+z+",sizingmethod='auto expand')")})})}},refresh:function(b,f){if(f&&a[f.id]&&(f.visible===o||f.visible)){this._cancelUnloaded(b,f);var v=b._getBbox(),w=k,t=a[f.id],B=t.serviceContainer,E=b.options.tilingScheme,F=E.tileWidth,z=E.tileHeight,
D=Math.floor((v[0]-E.origin[0])/(w*F)),L=Math.floor((E.origin[1]-v[3])/(w*z)),T=Math.ceil((v[2]-E.origin[0])/(w*F)),N=Math.ceil((E.origin[1]-v[1])/(w*z)),O=b._getBboxMax(),M=b._getTiledPixelSize(0),ba=M/w,R=Math.floor((O[0]-E.origin[0])/(M*F))*ba,V=Math.floor((E.origin[1]-O[3])/(M*z))*ba,W=Math.round((E.origin[0]+R*F*w-v[0])/w),U=Math.round((v[3]-(E.origin[1]-V*z*w))/w);v=B.children().show();O=v.filter("[data-pixelSize='"+w+"']").appendTo(B);var S=f.opacity===o?1:f.opacity;t.reloadTiles&&v.find("img").attr("data-dirty",
"true");if(O.size()){O.css({left:W%F+"px",top:U%z+"px"}).data("scaleOrigin",W%F+","+U%z);O.children().each(function(){var ca=d(this),ha=ca.attr("data-tile").split(",");ca.css({left:Math.round((parseInt(ha[0])-R)*100+(W-W%F)/F*100)+"%",top:Math.round((parseInt(ha[1])-V)*100+(U-U%z)/z*100)+"%"});S<1&&ca.fadeTo(0,S)})}else{B.append("<div style='position:absolute; left:"+W%F+"px; top:"+U%z+"px; width:"+F+"px; height:"+z+"px; margin:0; padding:0;' data-pixelSize='"+w+"'></div>");O=B.children(":last").data("scaleOrigin",
W%F+","+U%z)}for(D=D;D<T;D++)for(M=L;M<N;M++){ba=""+D+","+M;var Y=O.children("[data-tile='"+ba+"']").removeAttr("data-dirty");if(Y.size()===0||t.reloadTiles){var ka=[E.origin[0]+D*F*w,E.origin[1]-M*z*w],la=[E.origin[0]+((D+1)*F-1)*w,E.origin[1]-((M+1)*z-1)*w];ka=f.getUrl({bbox:[ka[0],ka[1],la[0],la[1]],width:F,height:z,zoom:b._getZoom(),tile:{row:M,column:D},index:Math.abs(M+D)});t.loadCount++;if(t.reloadTiles&&Y.size()>0)Y.attr("src",ka);else{Y="<img style='position:absolute; left:"+((D-R)*100+(W-
W%F)/F*100)+"%; top:"+((M-V)*100+(U-U%z)/z*100)+"%; ";if(d("body")[0].filters===o)Y+="width: 100%; height: 100%;";Y+="margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;' unselectable='on' data-tile='"+ba+"' />";O.append(Y);Y=O.children(":last");Y.load(function(ca){S<1?d(ca.target).fadeTo(0,S):d(ca.target).show();t.loadCount--;if(t.loadCount<=0){B.children(":not([data-pixelSize='"+w+"'])").remove();t.loadCount=0}}).error(function(ca){d(ca.target).remove();
t.loadCount--;if(t.loadCount<=0){B.children(":not([data-pixelSize='"+w+"'])").remove();t.loadCount=0}}).attr("src",ka)}}}v.find("[data-dirty]").remove();t.reloadTiles=false}},_cancelUnloaded:function(b,f){var v=a[f.id];if(v&&v.loadCount>0)for(v.serviceContainer.find("img:hidden").remove();v.loadCount>0;)v.loadCount--}}}(),shingled:function(){var a={};return{create:function(b,f){if(!a[f.id]){a[f.id]={loadCount:0};l.append('<div data-service="'+f.id+'" style="position:absolute; left:0; top:0; width:16px; height:16px; margin:0; padding:0; display:'+
(f.visible===o||f.visible?"block":"none")+';"></div>');a[f.id].serviceContainer=l.children('[data-service="'+f.id+'"]')}},destroy:function(b,f){a[f.id].serviceContainer.remove();delete a[f.id]},interactivePan:function(b,f,v,w){if(a[f.id]){this._cancelUnloaded(b,f);b=a[f.id].serviceContainer.children("[data-pixelSize='"+k+"']");f=b.children("div");if(!f.length){b.children("img").wrap('<div style="position:absolute; left:0; top:0; width:100%; height:100%;"></div>');f=b.children("div")}f.css({left:function(t,
B){return parseInt(B)+v},top:function(t,B){return parseInt(B)+w}})}},interactiveScale:function(b,f,v,w){if(a[f.id]){this._cancelUnloaded(b,f);var t=j.width,B=j.height,E=t/2,F=B/2;a[f.id].serviceContainer.children().each(function(){var z=d(this),D=z.attr("data-pixelSize"),L=D/w;z.css({width:t*L,height:B*L}).children("img").each(function(){var T=d(this),N=T.data("center");T.css({left:(Math.round((N[0]-v[0])/D)-E)*L+"px",top:(Math.round((v[1]-N[1])/D)-F)*L+"px"})})})}},refresh:function(b,f){if(f&&a[f.id]&&
(f.visible===o||f.visible)){this._cancelUnloaded(b,f);var v=b._getBbox(),w=k,t=a[f.id],B=t.serviceContainer,E=j.width,F=j.height,z=E/2,D=F/2,L=B.children('[data-pixelSize="'+w+'"]'),T=f.opacity===o?1:f.opacity;if(!L.size()){B.append('<div style="position:absolute; left:'+z+"px; top:"+D+"px; width:"+E+"px; height:"+F+'px; margin:0; padding:0;" data-pixelSize="'+w+'"></div>');L=B.children(":last")}L.children("img").each(function(){var N=d(this),O=N.data("center");N.css({left:Math.round((O[0]-r[0])/
w)-z+"px",top:Math.round((r[1]-O[1])/w)-D+"px"})});T<1&&B.find("img").attr("data-keepAlive","0");v=f.getUrl({bbox:v,width:E,height:F,zoom:b._getZoom(),tile:null,index:0});t.loadCount++;L.append('<img style="position:absolute; left:-'+z+"px; top:-"+D+'px; width:100%; height:100%; margin:0; padding:0; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none; display:none;" unselectable="on" />');L.children(":last").data("center",r).load(function(N){T<1?d(N.target).fadeTo(0,
T):d(N.target).show();t.loadCount--;if(t.loadCount<=0){B.children(':not([data-pixelSize="'+w+'"])').remove();N=B.find('[data-pixelSize="'+w+'"]>div');if(N.size()>0){var O=N.position();N.children("img").each(function(){var M=d(this),ba=O.left+parseInt(M.css("left")),R=O.top+parseInt(M.css("top"));M.css({left:ba+"px",top:R+"px"})}).unwrap();N.remove()}t.loadCount=0}}).error(function(N){d(N.target).remove();t.loadCount--;if(t.loadCount<=0){B.children(":not([data-pixelSize='"+w+"'])").remove();t.loadCount=
0}}).attr("src",v)}},_cancelUnloaded:function(b,f){var v=a[f.id];if(v&&v.loadCount>0)for(v.serviceContainer.find("img:hidden").remove();v.loadCount>0;)v.loadCount--}}}()}};d.widget("geo.geomap",function(){return{options:d.extend({},X),_createWidget:function(a,b){C=a;s=d(b);this._forcePosition(s);s.css("text-align","left");var f=this._findMapSize();j={x:parseInt(s.css("padding-left")),y:parseInt(s.css("padding-top")),width:f.width,height:f.height};this._createChildren();r=y=[0,0];k=K=156543.03392799935;
I=P=J=ja=da=g=q=false;ea=Q=aa=ia=A=[0,0];fa=[0.8,0.8];na=Z=0;d.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){p=this.options;e=(ga="ontouchend"in document)||ma==7;var a=ga?"touchstart":"mousedown",b=ga?"touchend touchcancel":"mouseup",f=ga?"touchmove":"mousemove";u.dblclick(d.proxy(this._eventTarget_dblclick,this));u.bind(a,d.proxy(this._eventTarget_touchstart,this));a=u[0].setCapture?u:d(document);a.bind(f,d.proxy(this._dragTarget_touchmove,this));a.bind(b,d.proxy(this._dragTarget_touchstop,
this));u.mousewheel(d.proxy(this._eventTarget_mousewheel,this));n.geographics();if(C){C.bbox&&this._setOption("bbox",C.bbox,false);C.center&&this._setOption("center",C.center,false);C.zoom&&this._setZoom(C.zoom,false,false)}u.css("cursor",p.cursors[p.mode]);this._createServices();this._refresh()},_setOption:function(a,b,f){f=f===o||f;switch(a){case "bbox":if(d.geo.proj){b=d.geo.proj.fromGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}this._setBbox(b,false,f);b=this._getBbox();
if(d.geo.proj){b=d.geo.proj.toGeodetic([[b[0],b[1]],[b[2],b[3]]]);b=[b[0][0],b[0][1],b[1][0],b[1][1]]}break;case "center":this._setCenterAndSize(d.geo.proj?d.geo.proj.fromGeodetic([[b[0],b[1]]])[0]:b,k,false,f);break;case "zoom":this._setZoom(b,false,f)}d.Widget.prototype._setOption.apply(this,arguments);switch(a){case "services":this._createServices();f&&this._refresh()}},destroy:function(){d.Widget.prototype.destroy.apply(this,arguments);this.element.html("")},getPixelSize:function(){return k},
toMap:function(a){a=this._toMap(a);return d.geo.proj?d.geo.proj.toGeodetic(a):a},toPixel:function(a){a=d.geo.proj?d.geo.proj.fromGeodetic(a):a;return this._toPixel(a)},refresh:function(){this._refresh()},shapeStyle:function(a){if(a){n.geographics("option","style",a);this._refresh()}else return n.geographics("option","style")},append:function(a,b,f){f=f===o||f;if(a){a=a.type=="FeatureCollection"?a.features:d.isArray(a)?a:[a];d.each(a,function(){x[x.length]={shape:this,style:b}});f&&this._refresh()}},
empty:function(){x=[];this._refresh()},find:function(a,b){this.toPixel(a.coordinates);var f=k*b,v=[];d.each(x,function(){d.geo._distance(this.shape,a)<f&&v.push(this.shape)});return v},remove:function(a){d.each(x,function(b){if(this.shape==a){var f=x.slice(b+1||x.length);x.length=b<0?x.length+b:b;x.push.apply(x,f);return false}});this._refresh()},_getBbox:function(){var a=j.width/2*k,b=j.height/2*k;return[r[0]-a,r[1]-b,r[0]+a,r[1]+b]},_setBbox:function(a,b,f){var v=[a[0]+(a[2]-a[0])/2,a[1]+(a[3]-
a[1])/2];a=Math.max(d.geo._width(a)/j.width,d.geo._height(a)/j.height);if(p.tilingScheme)a=this._getTiledPixelSize(this._getTiledZoom(a));this._setCenterAndSize(v,a,b,f)},_getBboxMax:function(){var a=j.width/2*K,b=j.height/2*K;return[y[0]-a,y[1]-b,y[0]+a,y[1]+b]},_getZoom:function(){if(p.tilingScheme)return this._getTiledZoom(k);else{var a=j.width/j.height,b=d.geo._reaspect(this._getBbox(),a);a=d.geo._reaspect(this._getBboxMax(),a);return Math.log(d.geo._width(a)/d.geo._width(b))/Math.log(2)}},_setZoom:function(a,
b,f){a=Math.max(a,0);if(p.tilingScheme)this._setCenterAndSize(r,this._getTiledPixelSize(a),b,f);else{a=d.geo._scaleBy(this._getBbox(),1/Math.pow(2,a));a=Math.max(d.geo._width(a)/j.width,d.geo._height(a)/j.height);this._setCenterAndSize(r,a,b,f)}},_createChildren:function(){var a=s.children().detach();this._forcePosition(a);a.css("-moz-user-select","none");s.prepend("<div style='position:absolute; left:"+j.x+"px; top:"+j.y+"px; width:"+j.width+"px; height:"+j.height+"px; margin:0; padding:0; overflow:hidden; -khtml-user-select:none; -moz-user-select:none; -webkit-user-select:none; user-select:none;' unselectable='on'></div>");
u=c=s.children(":first");c.append('<div style="position:absolute; left:0; top:0; width:'+j.width+"px; height:"+j.height+'px; margin:0; padding:0;"></div>');l=c.children(":last");c.append('<div style="position:absolute; left:0; top:0; width:'+j.width+"px; height:"+j.height+'px; margin:0; padding:0;"></div>');n=c.children(":last");c.append('<div class="ui-widget ui-widget-content ui-corner-all" style="position:absolute; left:0; top:0px; max-width:128px; display:none;"><div style="margin:.2em;"></div></div>');
m=c.children(":last");m.children();c.append(a)},_createServices:function(){var a;for(a=0;a<h.length;a++)p._serviceTypes[h[a].type].destroy(this,h[a]);for(a=0;a<p.services.length;a++)p._serviceTypes[p.services[a].type].create(this,p.services[a],a);h=p.services},_drawGraphics:function(a,b,f){var v,w,t,B,E,F=this;for(v=0;v<b.length;v++){t=b[v].shape||b[v];t=t.geometry||t;B=d.isArray(f)?f[v].style:f;switch(t.type){case "Point":n.geographics("drawPoint",this.toPixel(t.coordinates),B);break;case "LineString":n.geographics("drawLineString",
this.toPixel(t.coordinates),B);break;case "Polygon":E=[];d.each(t.coordinates,function(z){E[z]=F.toPixel(this)});n.geographics("drawPolygon",E,B);break;case "MultiPoint":for(w=0;w<t.coordinates;w++)n.geographics("drawPoint",this.toPixel(t.coordinates[w]),B);break;case "MultiLineString":for(w=0;w<t.coordinates;w++)n.geographics("drawLineString",this.toPixel(t.coordinates[w]),B);break;case "MultiPolygon":for(w=0;w<t.coordinates;w++){E=[];d.each(t.coordinates[w],function(z){E[z]=F.toPixel(this)});n.geographics("drawPolygon",
E,B)}break;case "GeometryCollection":F._drawGraphics(a,t.geometries,B)}}},_findMapSize:function(){for(var a={width:0,height:0},b=s;b.size()&&!(a.width>0&&a.height>0);){a={width:b.width(),height:b.height()};if(a.width<=0||a.height<=0)a={width:parseInt(b.css("width")),height:parseInt(b.css("height"))};b=b.parent()}return a},_forcePosition:function(a){var b=a.css("position");b!="relative"&&b!="absolute"&&b!="fixed"&&a.css("position","relative")},_getTiledPixelSize:function(a){var b=p.tilingScheme;if(b!=
null){if(a===0)return b.pixelSizes!=null?b.pixelSizes[0]:b.basePixelSize;a=Math.round(a);a=Math.max(a,0);a=Math.min(a,(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-1);return b.pixelSizes!=null?b.pixelSizes[a]:b.basePixelSize/Math.pow(2,a)}else return NaN},_getTiledZoom:function(a){var b=p.tilingScheme;if(b.pixelSizes!=null){a=Math.round(a);for(var f=(b.pixelSizes!=null?b.pixelSizes.length:b.levels)-1;f>=0;f--)if(Math.round(b.pixelSizes[f])>=a)return f;return 0}else return Math.max(Math.round(Math.log(b.basePixelSize/
a)/Math.log(2)),0)},_getWheelCenterAndSize:function(){var a;if(p.tilingScheme){a=this._getTiledZoom(k)+G;a=this._getTiledPixelSize(a)}else{a=Math.pow(1.18920711500273,-G);a=k*a}var b=a/k,f=this._toMap(ea);b=[(r[0]-f[0])*b,(r[1]-f[1])*b];return{pixelSize:a,center:[f[0]+b[0],f[1]+b[1]]}},_mouseWheelFinish:function(){H=null;if(G!=0){var a=this._getWheelCenterAndSize();G=0;this._setCenterAndSize(a.center,a.pixelSize,true,true)}else this._refresh()},_panEnd:function(){A=[A[0]>0?Math.floor(A[0]*fa[0]):
Math.ceil(A[0]*fa[0]),A[1]>0?Math.floor(A[1]*fa[1]):Math.ceil(A[1]*fa[1])];if(Math.abs(A[0])<4&&Math.abs(A[1])<4)this._panFinalize();else{Q=[Q[0]+A[0],Q[1]+A[1]];this._panMove();setTimeout(d.proxy(this._panEnd,this),30)}},_panFinalize:function(){if(da){A=[0,0];var a=-(Q[0]-ea[0])*k,b=(Q[1]-ea[1])*k;n.css({left:0,top:0});this._setCenterAndSize([r[0]+a,r[1]+b],k,true,true);P=false;ea=Q;J=da=false;u.css("cursor",p.cursors[p.mode])}},_panMove:function(){var a=Q[0]-ia[0],b=Q[1]-ia[1];if(J||a>3||a<-3||
b>3||b<-3){if(!J){J=true;u.css("cursor",p.cursors.pan)}if(I)A=[a,b];if(a!=0||b!=0){da=true;ia=Q;for(i=0;i<p.services.length;i++){var f=p.services[i];p._serviceTypes[f.type].interactivePan(this,f,a,b)}n.css({left:function(v,w){return parseInt(w)+a},top:function(v,w){return parseInt(w)+b}})}}},_refresh:function(){for(var a=0;a<p.services.length;a++){var b=p.services[a];!I&&p._serviceTypes[b.type]!=null&&p._serviceTypes[b.type].refresh(this,b)}if(n){n.geographics("clear");x.length>0&&this._drawGraphics(n,
x,x)}},_setCenterAndSize:function(a,b,f,v){if(k!=b){n.geographics("clear");for(var w=0;w<p.services.length;w++){var t=p.services[w];p._serviceTypes[t.type].interactiveScale(this,t,a,b)}}r=a;k=b;if(d.geo.proj){a=this._getBbox();a=d.geo.proj.toGeodetic([[a[0],a[1]],[a[2],a[3]]]);a=[a[0][0],a[0][1],a[1][0],a[1][1]];p.bbox=a;p.center=d.geo.proj.toGeodetic([[r[0],r[1]]])[0]}else{p.bbox=this._getBbox();p.center=r}p.zoom=this._getZoom();f&&this._trigger("bboxchange",window.event,{bbox:p.bbox});v&&this._refresh()},
_toMap:function(a,b,f){var v=d.isArray(a[0]);v||(a=[a]);b=b||r;f=f||k;var w=j.width,t=j.height,B=w/2*f;f=t/2*f;var E=[b[0]-B,b[1]-f,b[0]+B,b[1]+f],F=d.geo._width(E)/w,z=d.geo._height(E)/t,D=[];d.each(a,function(L){D[L]=[E[0]+this[0]*F,E[3]-this[1]*z]});return v?D:D[0]},_toPixel:function(a,b,f){var v=d.isArray(a[0]);v||(a=[a]);b=b||r;f=f||k;var w=j.width,t=j.height,B=w/2*f;f=t/2*f;var E=[b[0]-B,b[1]-f,b[0]+B,b[1]+f],F=d.geo._width(E),z=d.geo._height(E),D=[];d.each(a,function(L){D[L]=[Math.round((this[0]-
E[0])*w/F),Math.round((E[3]-this[1])*t/z)]});return v?D:D[0]},_zoomTo:function(a,b,f,v){b=b<0?0:b;var w=this._getTiledPixelSize(b);if(isNaN(w)){b=d.geo._scaleBy(this._getBboxMax(),1/Math.pow(2,b));b=Math.max(d.geo._width(b)/j.width,d.geo._height(b)/j.height);this._setCenterAndSize(a,b,f,v)}else this._setCenterAndSize(a,w,f,v)},_eventTarget_dblclick:function(a){this._panFinalize();d(a.currentTarget).offset();switch(p.mode){case "pan":this._trigger("dblclick",a,{type:"Point",coordinates:this.toMap(Q)});
a.isDefaultPrevented()||this._zoomTo(this._toMap(Q),this._getZoom()+1,true,true)}P=false},_eventTarget_touchstart:function(a){if(!(!ga&&a.which!=1)){if(e){var b=d.now();q=b-na<750?q?false:g:false;g=true;na=b}a.preventDefault();this._panFinalize();this._mouseWheelFinish();b=d(a.currentTarget).offset();Q=ga?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];I=true;ea=Q;if(!P&&a.shiftKey){ja=true;u.css("cursor",p.cursors.zoom)}else{P=
true;switch(p.mode){case "pan":ia=Q;a.currentTarget.setCapture&&a.currentTarget.setCapture()}}return false}},_dragTarget_touchmove:function(a){var b=u.offset();b=ga?[a.originalEvent.changedTouches[0].pageX-b.left,a.originalEvent.changedTouches[0].pageY-b.top]:[a.pageX-b.left,a.pageY-b.top];if(!(b[0]==aa[0]&&b[1]==aa[1])){if(e)q=g=false;if(I){Q=b;d.now()}switch(ja?"zoom":p.mode){case "pan":I||J?this._panMove():this._trigger("move",a,{type:"Point",coordinates:this.toMap(b)})}aa=b}},_dragTarget_touchstop:function(a){!I&&
ma==7&&this._eventTarget_touchstart(a);var b=I,f=J,v=u.offset();v=ga?[a.originalEvent.changedTouches[0].pageX-v.left,a.originalEvent.changedTouches[0].pageY-v.top]:[a.pageX-v.left,a.pageY-v.top];var w=ja?"zoom":p.mode;u.css("cursor",p.cursors[w]);ja=I=J=false;document.releaseCapture&&document.releaseCapture();if(b){b=d.now();Q=v;switch(w){case "pan":if(f)this._panEnd();else if(b-Z>100){this._trigger("click",a,{type:"Point",coordinates:this.toMap(v)});P=false}}Z=b;if(e&&q){q=g=false;u.trigger("dblclick",
a)}}},_eventTarget_mousewheel:function(a,b){a.preventDefault();this._panFinalize();if(!I){if(b!=0){if(H){window.clearTimeout(H);H=null}else{var f=d(a.currentTarget).offset();ea=[a.pageX-f.left,a.pageY-f.top]}G+=b;f=this._getWheelCenterAndSize();n.geographics("clear");for(i=0;i<p.services.length;i++){var v=p.services[i];p._serviceTypes[v.type].interactiveScale(this,v,f.center,f.pixelSize)}var w=this;H=window.setTimeout(function(){w._mouseWheelFinish()},1E3)}return false}}}}())})(jQuery);
